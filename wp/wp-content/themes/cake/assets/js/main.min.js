"use strict";window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var a=0;a<this.length;a++)e.call(t,this[a],a,this)});var items=document.querySelectorAll(".cake__item");[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),a=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;a.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(a)}})}),function(){var e=[window.Element,window.CharacterData,window.DocumentType],t=[];e.forEach(function(e){e&&t.push(e.prototype)}),t.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}();try{var btn=document.querySelector(".menu__menu"),block=document.querySelector(".menu__list");btn.addEventListener("click",function(){btn.classList.toggle("menu__menu-active"),btn.classList.contains("menu__menu-active")?block.style.display="block":block.style.display="none"})}catch(e){}try{var addClass=function(e,a,o){document.querySelectorAll(e).forEach(function(e){var t;e.classList.add(a),o&&((t=document.createElement("div")).classList.add(o),e.append(t))})};addClass(".footer li","footer__item","footer__line"),addClass(".header .header__list li","header__item","header__line"),addClass(".header__list-hamburger li","header__item-hamburger",!1);try{var burgerActive=document.createElement("div");burgerActive.classList.add("burger-line"),document.querySelector(".burger-active").append(burgerActive)}catch(e){}}catch(e){}var category=document.querySelectorAll(".taxonomy.category_menu"),spans=document.querySelectorAll(".current-item");category.forEach(function(e){e.classList.add("infoTorts__home")}),spans.forEach(function(e){e.classList.add("infoTorts__next")});try{items.forEach(function(e){e.addEventListener("mouseover",function(e){var t,a=e.target.closest(".cake__item");if(a&&!a.querySelector(".cake__info")){switch(a.dataset.element){case"1":t="cake__goRight";break;case"2":t="cake__goCenter";break;case"3":t="cake__goLeft"}var o=document.createElement("div");o.classList.add("cake__info",t),console.log(o),o.innerHTML='\n                <h3 class="cake__title">'.concat(a.dataset.name,'</h3>\n                <p class="cake__description">').concat(a.dataset.info,'</p>\n                <div class="cake__footer">\n                <span class="cake__gram">').concat(a.dataset.gramm,'г.</span>\n                <span class="cake__price">').concat(a.dataset.price,"Р</span>\n                "),a.append(o)}})}),items.forEach(function(e){e.addEventListener("mouseleave",function(e){document.querySelector(".cake__info").remove()})})}catch(e){}try{var checbox=document.querySelector(".application__label-checkbox"),button=document.querySelector(".application__submit");checbox.addEventListener("click",function(e){var t=checbox.querySelector(".application__checkbox-bad"),a=checbox.querySelector(".application__checkbox-bad-block");t.checked?(t.checked=!1,a.classList.remove("application__checkbox-bad-block-active"),button.classList.add("modal__disabled"),button.classList.remove("modal__submit")):(t.checked=!0,a.classList.add("application__checkbox-bad-block-active"),button.classList.remove("modal__disabled"),button.classList.add("modal__submit"))})}catch(e){}$("form").on("submit",function(e){e.preventDefault();var t=$(this).serializeArray(),a=$(this).attr("action");$.post(myajax.url,{form:t,action:a},function(e){for(var t=0;t<$("form").length;t++)$("form")[t].reset();console.log(e),$(this).find(".form__btn").toggleClass("is-disabled",!0)})});try{var checkbox=document.querySelector(".modal__checkbox"),btnSubmit=document.querySelector(".modal__button"),applicationCheckBox=document.querySelector(".application__checkbox-bad"),applicationSubmit=document.querySelector(".application__submit");try{checkbox.addEventListener("change",function(){checkbox.checked?(btnSubmit.classList.remove("modal__disabled"),btnSubmit.classList.add("modal__submit")):(btnSubmit.classList.add("modal__disabled"),btnSubmit.classList.remove("modal__submit"))})}catch(e){}try{applicationCheckBox.addEventListener("change",function(e){applicationCheckBox.checked?(applicationSubmit.classList.remove("modal__disabled"),applicationSubmit.classList.add("modal__submit")):(applicationSubmit.classList.add("modal__disabled"),applicationSubmit.classList.remove("modal__submit"))})}catch(e){}}catch(e){}try{document.querySelector(".menu-icon").addEventListener("click",function(e){e.target.closest(".menu-icon").classList.toggle("clicked"),document.querySelector(".menu-icon").classList.contains("clicked")?document.querySelector(".header__list-hamburger").classList.add("active-list","header__list-hamburger-animate"):document.querySelector(".header__list-hamburger").classList.remove("active-list")})}catch(e){}try{var iframe=document.createElement("iframe")}catch(e){}try{$(window).scroll(function(){$(document).scrollTop()>$(document).height()-1100&&!$("body").hasClass("loading")&&"undefined"!=typeof true_posts&&(console.log(true_posts),$("body").addClass("loading"),$.post(myajax.url,{action:"news_loadmore",query:true_posts||"",page:current_page||""},function(e){e?(current_page++,$(".menu__loading").before(e),$("body").removeClass("loading")):$(".menu__loading").remove()}))})}catch(e){}try{var btns=document.querySelector(".tort__items"),modal=document.querySelector(".modal"),dialog=document.querySelector(".modal__dialog"),_block=document.querySelector(".modal__block");btns.addEventListener("click",function(e){var t,a,o;e.target.closest(".tort__item")&&(document.body.style.overflow="hidden",modal.style.transition="all 1s",modal.style.overflow="auto",modal.classList.add("modal-active"),t=e.target.closest(".tort__item"),(a=document.createElement("div")).classList.add("modal__infoTort"),a.innerHTML='\n                <h2 class="modal__title">Онлайн заказ торта</h2>\n                <div class="modal__info">\n                    <div class="modal__img-block">\n                        <img src="'.concat(t.dataset.img,'" alt="tort" class="modal__img">\n                    </div>\n                    <div class="modal__description">\n                        <h5 class="modal__name">').concat(t.dataset.nameTort,'</h5>\n                        <p class="modal__text">\n                            ').concat(t.dataset.description,'\n                        </p>\n                    </div>\n                </div>\n                <div class="modal__bottom">\n                    <div class="modal__line"></div>\n                    <div class="modal__opis">\n                        <div class="modal__gram">').concat(t.dataset.kg,' кг.</div>\n                        <div class="modal__price">').concat(t.dataset.rub," ₽</div>\n                    </div>\n                </div>\n            "),_block.append(a),(o=document.createElement("input")).classList.add("input__hidden"),o.value=t.dataset.nameTort,document.querySelector(".hidden__label").append(o))}),modal.addEventListener("click",function(e){e.target.classList.contains("modal")&&(document.body.style.overflow="",modal.style.transition="none",modal.classList.remove("modal-active"),modal.querySelector(".modal__infoTort").remove(),document.querySelector(".hidden__label").querySelector(".input__hidden").remove())})}catch(e){}try{var conts=document.querySelectorAll(".cont"),inputs=document.querySelector(".application").querySelectorAll(".application-input");conts.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.closest(".cont");t.querySelector("input").focus(),t.querySelector(".placeholder").style.display="none"})}),inputs.forEach(function(e){e.addEventListener("blur",function(e){""==e.target.value.trim()&&(e.target.parentElement.nextElementSibling.style.display="block")})})}catch(e){}try{var labels=document.querySelectorAll(".application__label");labels.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.closest(".application__label").querySelector(".application__checkbox"),a=e.target.closest(".application__label").querySelector(".application__checkbox-block");t.checked||(console.log("true"),document.querySelectorAll(".application__checkbox-block").forEach(function(e){e.classList.remove("application__checkbox-block-active")}),document.querySelectorAll(".application__checkbox").forEach(function(e){e.checked=!1}),a.classList.add("application__checkbox-block-active"),t.checked=!0)})})}catch(e){}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var a=0;a<this.length;a++)e.call(t,this[a],a,this)});try{var addDots=function(){var o=document.createElement("div");o.classList.add("slider__dots"),elements.forEach(function(e,t){var a=document.createElement("div");a.classList.add("slider__dot"),a.setAttribute("data-count",t+1),0===t&&a.classList.add("slider__dot-active"),o.appendChild(a)}),document.querySelector(".slider").appendChild(o)},startInterval=function(){interval=setInterval(goNext,6e3)},changeDots=function(e,t){var a,o;e&&(slider.querySelectorAll(".slider__dot").forEach(function(e){e.classList.remove("slider__dot-active")}),e.target.classList.add("slider__dot-active"),a=e.target.getAttribute("data-count"),o=(count=a)*parseInt(width)-parseInt(width),content.style.transform="translateX(-".concat(o,"px)")),t&&slider.querySelectorAll(".slider__dot").forEach(function(e,t){e.classList.remove("slider__dot-active"),t+1===count&&e.classList.add("slider__dot-active")})},goNext=function(){var e;count===elements.length?(content.style.transform="translateX(0)",count=1):(e=(++count-1)*parseInt(width),content.style.transform="translateX(-".concat(e,"px)")),changeDots(null,"changeColor")},goPrev=function(){var e,t;1===count?(e=(elements.length-1)*parseInt(width)+"px",content.style.transform="translateX(-".concat(e,")"),count=elements.length):(t=--count*parseInt(width)-parseInt(width),content.style.transform="translateX(-".concat(t,"px)")),changeDots(null,"changeColor")};!function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,e.closest=e.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null}}(Element.prototype);var interval,width=window.getComputedStyle(document.querySelector(".slider__wrapper")).width,wrapper=document.querySelector(".slider__wrapper"),elements=document.querySelectorAll(".slider__item"),content=document.querySelector(".slider__content"),prev=document.querySelector(".slider__left"),next=document.querySelector(".slider__right"),slider=document.querySelector(".slider"),count=1;addDots(),content.style.width=elements.length*parseInt(width)+"px",next.addEventListener("click",goNext),prev.addEventListener("click",goPrev),startInterval(),wrapper.addEventListener("mouseenter",function(){clearInterval(interval)}),wrapper.addEventListener("mouseleave",function(){startInterval()}),slider.querySelectorAll(".slider__dot").forEach(function(e){e.addEventListener("click",function(e){return changeDots(e,null)})})}catch(e){}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY2FyZGVvbi5qcyIsImFkZENsYXNzLmpzIiwiYnJlYWQuanMiLCJjYWtlLmpzIiwiY2hlY2tib3guanMiLCJmZXRjaC5qcyIsImZvcm0uanMiLCJoYW1idXJnZXIuanMiLCJpZnJhbWUuanMiLCJsb2FkbW9yZS5qcyIsIm1vZGFsLmpzIiwicGxhY2Vob2xkZXIuanMiLCJyYWRpb2J1dHRvbnMuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsid2luZG93IiwiTm9kZUxpc3QiLCJwcm90b3R5cGUiLCJmb3JFYWNoIiwiY2FsbGJhY2siLCJ0aGlzQXJnIiwiaSIsInRoaXMiLCJsZW5ndGgiLCJjYWxsIiwiaXRlbXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJFbGVtZW50IiwiRG9jdW1lbnQiLCJEb2N1bWVudEZyYWdtZW50IiwiaXRlbSIsImhhc093blByb3BlcnR5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJ2YWx1ZSIsImFyZ0FyciIsIkFycmF5Iiwic2xpY2UiLCJhcmd1bWVudHMiLCJkb2NGcmFnIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImFyZ0l0ZW0iLCJpc05vZGUiLCJOb2RlIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsIlN0cmluZyIsImFyciIsIkNoYXJhY3RlckRhdGEiLCJEb2N1bWVudFR5cGUiLCJhcmdzIiwicHVzaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImJ0biIsInF1ZXJ5U2VsZWN0b3IiLCJibG9jayIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjb250YWlucyIsInN0eWxlIiwiZGlzcGxheSIsIl91bnVzZWQiLCJhZGRDbGFzcyIsInNlbGVjdG9yIiwiY2xhc3NMaSIsImNsYXNzTGluZSIsImxpbmUiLCJhZGQiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kIiwiYnVyZ2VyQWN0aXZlIiwiX3VudXNlZDIiLCJfdW51c2VkMyIsImNhdGVnb3J5Iiwic3BhbnMiLCJlIiwidHJhbkNsYXNzIiwiYm9keSIsInRhcmdldCIsImNsb3Nlc3QiLCJkYXRhc2V0IiwiZWxlbWVudCIsImVsIiwiY29uc29sZSIsImxvZyIsImlubmVySFRNTCIsImNvbmNhdCIsIm5hbWUiLCJpbmZvIiwiZ3JhbW0iLCJwcmljZSIsInJlbW92ZSIsIl91bnVzZWQ0IiwiY2hlY2JveCIsImJ1dHRvbiIsIm9sZENoZWNrQm94IiwibmV3Q2hlY2tCb3giLCJjaGVja2VkIiwiX3VudXNlZDUiLCIkIiwib24iLCJwcmV2ZW50RGVmYXVsdCIsImZvcm0iLCJzZXJpYWxpemVBcnJheSIsImFjdGlvbiIsImF0dHIiLCJwb3N0IiwibXlhamF4IiwidXJsIiwiZGF0YSIsInJlc2V0IiwiZmluZCIsInRvZ2dsZUNsYXNzIiwiY2hlY2tib3giLCJidG5TdWJtaXQiLCJhcHBsaWNhdGlvbkNoZWNrQm94IiwiYXBwbGljYXRpb25TdWJtaXQiLCJfdW51c2VkNiIsIl91bnVzZWQ3IiwiX3VudXNlZDgiLCJfdW51c2VkOSIsImlmcmFtZSIsIl91bnVzZWQxMCIsInNjcm9sbCIsInNjcm9sbFRvcCIsImhlaWdodCIsImhhc0NsYXNzIiwidHJ1ZV9wb3N0cyIsInF1ZXJ5IiwicGFnZSIsImN1cnJlbnRfcGFnZSIsImJlZm9yZSIsInJlbW92ZUNsYXNzIiwiX3VudXNlZDExIiwiYnRucyIsIm1vZGFsIiwiZGlhbG9nIiwiaW5wdXRUb3J0Iiwib3ZlcmZsb3ciLCJ0cmFuc2l0aW9uIiwiaW1nIiwibmFtZVRvcnQiLCJkZXNjcmlwdGlvbiIsImtnIiwicnViIiwiX3VudXNlZDEyIiwiY29udHMiLCJpbnB1dHMiLCJmb2N1cyIsInRyaW0iLCJwYXJlbnRFbGVtZW50IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiX3VudXNlZDEzIiwibGFiZWxzIiwib2xkQ2hlY2tCb3hzIiwibmV3Q2hlY2tCb3hzIiwiX3VudXNlZDE0IiwiYWRkRG90cyIsImRvdHMiLCJlbGVtZW50cyIsImluZGV4IiwiZG90Iiwic2V0QXR0cmlidXRlIiwic3RhcnRJbnRlcnZhbCIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJnb05leHQiLCJjaGFuZ2VEb3RzIiwiY29sb3IiLCJyZXN1bHQiLCJzbGlkZXIiLCJnZXRBdHRyaWJ1dGUiLCJjb3VudCIsInBhcnNlSW50Iiwid2lkdGgiLCJjb250ZW50IiwidHJhbnNmb3JtIiwiZ29QcmV2IiwiRUxFTUVOVCIsIm1hdGNoZXMiLCJtb3pNYXRjaGVzU2VsZWN0b3IiLCJtc01hdGNoZXNTZWxlY3RvciIsIm9NYXRjaGVzU2VsZWN0b3IiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJnZXRDb21wdXRlZFN0eWxlIiwid3JhcHBlciIsInByZXYiLCJuZXh0IiwiY2xlYXJJbnRlcnZhbCIsIl91bnVzZWQxNSJdLCJtYXBwaW5ncyI6ImFBQUFBLE9BQUFDLFdBQUFBLFNBQUFDLFVBQUFDLFVBQ0FGLFNBQUFDLFVBQUFDLFFBQUEsU0FBQUMsRUFBQUMsR0FDQUEsRUFBQUEsR0FBQUwsT0FDQSxJQUFBLElBQUFNLEVBQUEsRUFBQUEsRUFBQUMsS0FBQUMsT0FBQUYsSUFDQUYsRUFBQUssS0FBQUosRUFBQUUsS0FBQUQsR0FBQUEsRUFBQUMsUUFJQSxJQUFBRyxNQUFBQyxTQUFBQyxpQkFBQSxlQXVCQSxDQUFBQyxRQUFBWCxVQUFBWSxTQUFBWixVQUFBYSxpQkFBQWIsV0FyQkFDLFFBQUEsU0FBQWEsR0FDQUEsRUFBQUMsZUFBQSxXQUdBQyxPQUFBQyxlQUFBSCxFQUFBLFNBQUEsQ0FDQUksY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLFVBQUEsRUFDQUMsTUFBQSxXQUNBLElBQUFDLEVBQUFDLE1BQUF2QixVQUFBd0IsTUFBQWpCLEtBQUFrQixXQUNBQyxFQUFBakIsU0FBQWtCLHlCQUVBTCxFQUFBckIsUUFBQSxTQUFBMkIsR0FDQSxJQUFBQyxFQUFBRCxhQUFBRSxLQUNBSixFQUFBSyxZQUFBRixFQUFBRCxFQUFBbkIsU0FBQXVCLGVBQUFD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QSxLQUFBLGlCQWhIQSxTQUFBVyxHQUNBQSxFQUFBQyxRQUFBRCxFQUFBQyxTQUFBRCxFQUFBRSxvQkFBQUYsRUFBQUcsbUJBQUFILEVBQUFJLGtCQUFBSixFQUFBSyxzQkFDQUwsRUFBQW5HLFFBQUFtRyxFQUFBbkcsU0FBQSxTQUFBaEIsR0FDQSxPQUFBL0MsS0FDQUEsS0FBQW1LLFFBQUFwSCxHQUFBL0MsS0FDQUEsS0FBQXNJLGNBQ0F0SSxLQUFBc0ksY0FBQXZFLFFBQUFoQixHQURBLEtBRkEsTUFIQSxDQVFBekMsUUFBQVgsV0FDQSxJQXVDQXlKLFNBdkNBVSxNQUFBckssT0FBQStLLGlCQUFBcEssU0FBQWlDLGNBQUEscUJBQUF5SCxNQUNBVyxRQUFBckssU0FBQWlDLGNBQUEsb0JBQ0EwRyxTQUFBM0ksU0FBQUMsaUJBQUEsaUJBQ0EwSixRQUFBM0osU0FBQWlDLGNBQUEsb0JBQ0FxSSxLQUFBdEssU0FBQWlDLGNBQUEsaUJBQ0FzSSxLQUFBdkssU0FBQWlDLGNBQUEsa0JBQ0FxSCxPQUFBdEosU0FBQWlDLGNBQUEsV0FFQXVILE1BQUEsRUF1QkFmLFVBR0FrQixRQUFBcEgsTUFBQW1ILE1BQUFmLFNBQUE5SSxPQUFBNEosU0FBQUMsT0FBQSxLQUVBYSxLQUFBcEksaUJBQUEsUUFBQStHLFFBQ0FvQixLQUFBbkksaUJBQUEsUUFBQTBILFFBT0FkLGdCQUVBc0IsUUFBQWxJLGlCQUFBLGFBQUEsV0FDQXFJLGNBQUF4QixZQUdBcUIsUUFBQWxJLGlCQUFBLGFBQUEsV0FDQTRHLGtCQUdBTyxPQUFBckosaUJBQUEsZ0JBQUFULFFBQUEsU0FBQWEsR0FDQUEsRUFBQThCLGlCQUFBLFFBQUEsU0FBQW9CLEdBQUEsT0FBQTRGLFdBQUE1RixFQUFBLFVBb0RBLE1BQUFrSCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaWYgKHdpbmRvdy5Ob2RlTGlzdCAmJiAhTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2gpIHtcclxuICAgIE5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdGhpc0FyZyA9IHRoaXNBcmcgfHwgd2luZG93O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHRoaXNbaV0sIGksIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuY29uc3QgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNha2VfX2l0ZW1cIik7XHJcbihmdW5jdGlvbiAoYXJyKSB7XHJcbiAgICBhcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICBpZiAoaXRlbS5oYXNPd25Qcm9wZXJ0eSgnYXBwZW5kJykpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGl0ZW0sICdhcHBlbmQnLCB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXHJcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZCgpIHtcclxuICAgICAgICAgIHZhciBhcmdBcnIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLFxyXG4gICAgICAgICAgICBkb2NGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gIFxyXG4gICAgICAgICAgYXJnQXJyLmZvckVhY2goZnVuY3Rpb24gKGFyZ0l0ZW0pIHtcclxuICAgICAgICAgICAgdmFyIGlzTm9kZSA9IGFyZ0l0ZW0gaW5zdGFuY2VvZiBOb2RlO1xyXG4gICAgICAgICAgICBkb2NGcmFnLmFwcGVuZENoaWxkKGlzTm9kZSA/IGFyZ0l0ZW0gOiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShTdHJpbmcoYXJnSXRlbSkpKTtcclxuICAgICAgICAgIH0pO1xyXG4gIFxyXG4gICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZChkb2NGcmFnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSkoW0VsZW1lbnQucHJvdG90eXBlLCBEb2N1bWVudC5wcm90b3R5cGUsIERvY3VtZW50RnJhZ21lbnQucHJvdG90eXBlXSk7XHJcbiAgKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGFyciA9IFt3aW5kb3cuRWxlbWVudCwgd2luZG93LkNoYXJhY3RlckRhdGEsIHdpbmRvdy5Eb2N1bWVudFR5cGVdO1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICBcclxuICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgYXJncy5wdXNoKGl0ZW0ucHJvdG90eXBlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgXHJcbiAgICAvLyBmcm9tOmh0dHBzOi8vZ2l0aHViLmNvbS9qc2Vyei9qc19waWVjZS9ibG9iL21hc3Rlci9ET00vQ2hpbGROb2RlL3JlbW92ZSgpL3JlbW92ZSgpLm1kXHJcbiAgICAoZnVuY3Rpb24gKGFycikge1xyXG4gICAgICBhcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgIGlmIChpdGVtLmhhc093blByb3BlcnR5KCdyZW1vdmUnKSkge1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaXRlbSwgJ3JlbW92ZScsIHtcclxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KShhcmdzKTtcclxuICB9KSgpO1xyXG50cnkge1xyXG4gICAgY29uc3QgYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51X19tZW51XCIpXHJcbiAgICBjb25zdCBibG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudV9fbGlzdFwiKTtcclxuXHJcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZShcIm1lbnVfX21lbnUtYWN0aXZlXCIpO1xyXG4gICAgICAgIGlmIChidG4uY2xhc3NMaXN0LmNvbnRhaW5zKFwibWVudV9fbWVudS1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgYmxvY2suc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBibG9jay5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0gY2F0Y2gge30iLCJcclxuXHJcbnRyeSB7XHJcbiAgICBmdW5jdGlvbiBhZGRDbGFzcyhzZWxlY3RvciwgY2xhc3NMaSwgY2xhc3NMaW5lKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKGNsYXNzTGkpO1xyXG4gICAgICAgICAgICBpZiAoY2xhc3NMaW5lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgICAgIGxpbmUuY2xhc3NMaXN0LmFkZChjbGFzc0xpbmUpO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5hcHBlbmQobGluZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhZGRDbGFzcyhcIi5mb290ZXIgbGlcIiwgXCJmb290ZXJfX2l0ZW1cIiwgXCJmb290ZXJfX2xpbmVcIik7XHJcbiAgICBhZGRDbGFzcyhcIi5oZWFkZXIgLmhlYWRlcl9fbGlzdCBsaVwiLCBcImhlYWRlcl9faXRlbVwiLCBcImhlYWRlcl9fbGluZVwiKTtcclxuICAgIGFkZENsYXNzKFwiLmhlYWRlcl9fbGlzdC1oYW1idXJnZXIgbGlcIiwgXCJoZWFkZXJfX2l0ZW0taGFtYnVyZ2VyXCIsIGZhbHNlKTtcclxuICAgIFxyXG4gICB0cnkge1xyXG4gICAgY29uc3QgYnVyZ2VyQWN0aXZlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGJ1cmdlckFjdGl2ZS5jbGFzc0xpc3QuYWRkKFwiYnVyZ2VyLWxpbmVcIik7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ1cmdlci1hY3RpdmVcIikuYXBwZW5kKGJ1cmdlckFjdGl2ZSk7XHJcbiAgIH0gY2F0Y2h7fVxyXG59IGNhdGNoIHt9IiwiLy8gY29uc3QgYnRuc0hvbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmhvbWVcIik7XHJcbmNvbnN0IGNhdGVnb3J5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50YXhvbm9teS5jYXRlZ29yeV9tZW51XCIpXHJcbmNvbnN0IHNwYW5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jdXJyZW50LWl0ZW1cIik7XHJcblxyXG5jYXRlZ29yeS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKFwiaW5mb1RvcnRzX19ob21lXCIpO1xyXG59KTtcclxuXHJcblxyXG5cclxuc3BhbnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChcImluZm9Ub3J0c19fbmV4dFwiKTtcclxufSk7XHJcblxyXG5cclxuLy8gaW5mb1RvcnRzX19ob21lIiwidHJ5IHtcclxuXHJcbml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZSA9PiB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuY2FrZV9faXRlbVwiKTtcclxuICAgICAgICBpZiAoYm9keSkge1xyXG4gICAgICAgICAgICBsZXQgdHJhbkNsYXNzO1xyXG4gICAgICAgICAgICBpZiAoIWJvZHkucXVlcnlTZWxlY3RvcihcIi5jYWtlX19pbmZvXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2goYm9keS5kYXRhc2V0LmVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiMVwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5DbGFzcyA9IFwiY2FrZV9fZ29SaWdodFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCIyXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbkNsYXNzID0gXCJjYWtlX19nb0NlbnRlclwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjNcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuQ2xhc3MgPSBcImNha2VfX2dvTGVmdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKFwiY2FrZV9faW5mb1wiLCB0cmFuQ2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZWwpO1xyXG4gICAgICAgICAgICAgICAgZWwuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzPVwiY2FrZV9fdGl0bGVcIj4ke2JvZHkuZGF0YXNldC5uYW1lfTwvaDM+XHJcbiAgICAgICAgICAgICAgICA8cCBjbGFzcz1cImNha2VfX2Rlc2NyaXB0aW9uXCI+JHtib2R5LmRhdGFzZXQuaW5mb308L3A+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FrZV9fZm9vdGVyXCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNha2VfX2dyYW1cIj4ke2JvZHkuZGF0YXNldC5ncmFtbX3Qsy48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNha2VfX3ByaWNlXCI+JHtib2R5LmRhdGFzZXQucHJpY2V90KA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICBgO1xyXG4gICAgICAgICAgICAgICAgYm9keS5hcHBlbmQoZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pO1xyXG5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBlID0+IHsgXHJcbiAgICAgICAgLy8gY29uc3QgaW1nID0gZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5jKFwiY2FrZV9faXRlbS1pbWdcIik7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYWtlX19pbmZvXCIpLnJlbW92ZSgpXHJcblxyXG4gICAgfSlcclxufSlcclxufSBjYXRjaCB7fVxyXG5cclxuIiwidHJ5IHtcclxuICAgIGNvbnN0IGNoZWNib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19sYWJlbC1jaGVja2JveFwiKTtcclxuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX3N1Ym1pdFwiKTtcclxuXHJcbiAgICBjaGVjYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG9sZENoZWNrQm94ID0gY2hlY2JveC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWRcIik7XHJcbiAgICAgICAgY29uc3QgbmV3Q2hlY2tCb3ggPSBjaGVjYm94LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94LWJhZC1ibG9ja1wiKTtcclxuXHJcbiAgICAgICAgaWYgKG9sZENoZWNrQm94LmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgb2xkQ2hlY2tCb3guY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBuZXdDaGVja0JveC5jbGFzc0xpc3QucmVtb3ZlKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJhZC1ibG9jay1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX2Rpc2FibGVkXCIpO1xyXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgb2xkQ2hlY2tCb3guY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIG5ld0NoZWNrQm94LmNsYXNzTGlzdC5hZGQoXCJhcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkLWJsb2NrLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59IGNhdGNoIHt9IiwiJCgnZm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB2YXIgZm9ybSA9ICQodGhpcykuc2VyaWFsaXplQXJyYXkoKTtcclxuICAgIHZhciBhY3Rpb24gPSAkKHRoaXMpLmF0dHIoJ2FjdGlvbicpO1xyXG4gICAgJC5wb3N0IChcclxuICAgICAgbXlhamF4LnVybCxcclxuICAgICAge1xyXG4gICAgICAgIGZvcm06IGZvcm0sXHJcbiAgICAgICAgYWN0aW9uOiBhY3Rpb25cclxuICAgICAgfSxcclxuICAgICAgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJCgnZm9ybScpLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAkKCdmb3JtJylbaV0ucmVzZXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpXHJcbiAgICAgICAgJCh0aGlzKS5maW5kKCcuZm9ybV9fYnRuJykudG9nZ2xlQ2xhc3MoJ2lzLWRpc2FibGVkJywgdHJ1ZSk7XHJcbiAgICAgIH1cclxuICAgIClcclxuICB9KTsiLCJ0cnkge1xyXG4gICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jaGVja2JveFwiKTtcclxuICAgIGNvbnN0IGJ0blN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIGNvbnN0IGFwcGxpY2F0aW9uQ2hlY2tCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWRcIik7XHJcbiAgICBjb25zdCBhcHBsaWNhdGlvblN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX3N1Ym1pdFwiKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY2hlY2tib3guY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgYnRuU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIGJ0blN1Ym1pdC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9IGNhdGNoe31cclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXBwbGljYXRpb25DaGVja0JveC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbkNoZWNrQm94LmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvblN1Ym1pdC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uU3VibWl0LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvblN1Ym1pdC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9IGNhdGNoIHt9XHJcbn0gY2F0Y2gge31cclxuXHJcblxyXG4iLCJ0cnkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51LWljb25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgZS50YXJnZXQuY2xvc2VzdChcIi5tZW51LWljb25cIikuY2xhc3NMaXN0LnRvZ2dsZShcImNsaWNrZWRcIik7XHJcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudS1pY29uXCIpLmNsYXNzTGlzdC5jb250YWlucyhcImNsaWNrZWRcIikpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2xpc3QtaGFtYnVyZ2VyXCIpLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtbGlzdFwiLCBcImhlYWRlcl9fbGlzdC1oYW1idXJnZXItYW5pbWF0ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlcl9fbGlzdC1oYW1idXJnZXJcIikuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZS1saXN0XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn0gY2F0Y2gge30iLCJ0cnkge1xyXG4gICAgbGV0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XHJcbiAgICBcclxuICAgIC8vIGh0dHBzOi8veWFuZGV4LnJ1L21hcC13aWRnZXQvdjEvP3VtPWNvbnN0cnVjdG9yJTNBOTI2MzZiMzQ5ZWIwNmYwY2M1YjlkNDMyM2VhMGYxZWIwMzFkNjM5OTkyNGUwZTBjMTcyODg2YjU3YjVjMWE3OSZhbXA7c291cmNlPWNvbnN0cnVjdG9yXHJcbn1jYXRjaCB7fSIsInRyeSB7XHJcbiAgICBcclxuXHJcbi8vIGpRdWVyeShmdW5jdGlvbigkKXtcclxuICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IGJvdHRvbU9mZnNldCA9IDExMDA7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJ0b3AgOiBcIiArICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpKVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiaGVpZ2h0IDogXCIgKyAkKGRvY3VtZW50KS5oZWlnaHQoKSlcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIm1pbnVzOiBcIiArICQoZG9jdW1lbnQpLmhlaWdodCgpIC0gYm90dG9tT2Zmc2V0KVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGJvdHRvbU9mZnNldClcclxuICAgICAgICBpZiggJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkgPiAoJChkb2N1bWVudCkuaGVpZ2h0KCkgLSBib3R0b21PZmZzZXQpICYmICEkKCdib2R5JykuaGFzQ2xhc3MoJ2xvYWRpbmcnKSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRydWVfcG9zdHMgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRydWVfcG9zdHMpXHJcbiAgICAgICAgICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ2xvYWRpbmcnKVxyXG4gICAgICAgICAgICAgICAgJC5wb3N0IChcclxuICAgICAgICAgICAgICAgICAgICBteWFqYXgudXJsLFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnbmV3c19sb2FkbW9yZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiB0cnVlX3Bvc3RzIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2UgOiBjdXJyZW50X3BhZ2UgfHwgXCJcIlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiggeGhyKXtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgXHQkKCdib2R5JykuYWRkQ2xhc3MoJ2xvYWRpbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgfSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGRhdGEgKSB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJCgnLm1lbnVfX2Zvb2RzJykuYXBwZW5kKGRhdGEpOyAvLyDQstGB0YLQsNCy0LvRj9C10Lwg0L3QvtCy0YvQtSDQv9C+0YHRgtGLXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3BhZ2UrKzsgLy8g0YPQstC10LvQuNGH0LjQstCw0LXQvCDQvdC+0LzQtdGAINGB0YLRgNCw0L3QuNGG0Ysg0L3QsCDQtdC00LjQvdC40YbRg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLm1lbnVfX2xvYWRpbmcnKS5iZWZvcmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcnKTtcclxuICAgIC8vIFx0XHRcdFx0XHRcdGN1cnJlbnRfcGFnZSsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJCgnI25ld3NfbG9hZG1vcmUnKS5yZW1vdmUoKTsgLy8g0LXRgdC70Lgg0LzRiyDQtNC+0YjQu9C4INC00L4g0L/QvtGB0LvQtdC00L3QtdC5INGB0YLRgNCw0L3QuNGG0Ysg0L/QvtGB0YLQvtCyLCDRgdC60YDQvtC10Lwg0LrQvdC+0L/QutGDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcubWVudV9fbG9hZGluZycpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbi8vIH0pO1xyXG5cclxuXHJcblxyXG59IGNhdGNoIHt9XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vIGpRdWVyeShmdW5jdGlvbigkKXtcclxuLy8gXHQkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCl7XHJcbi8vIFx0XHR2YXIgYm90dG9tT2Zmc2V0ID0gNDAwOyAvLyDQvtGC0YHRgtGD0L8g0L7RgiDQvdC40LbQvdC10Lkg0LPRgNCw0L3QuNGG0Ysg0YHQsNC50YLQsCwg0LTQviDQutC+0YLQvtGA0L7Qs9C+INC00L7Qu9C20LXQvSDQtNC+0YHQutGA0L7Qu9C70LjRgtGMINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCwg0YfRgtC+0LHRiyDQv9C+0LTQs9GA0YPQt9C40LvQuNGB0Ywg0L3QvtCy0YvQtSDQv9C+0YHRgtGLXHJcbi8vIFx0XHR2YXIgZGF0YSA9IHtcclxuLy8gXHRcdFx0J2FjdGlvbic6ICdsb2FkbW9yZScsXHJcbi8vIFx0XHRcdCdxdWVyeSc6IHRydWVfcG9zdHMsXHJcbi8vIFx0XHRcdCdwYWdlJyA6IGN1cnJlbnRfcGFnZVxyXG4vLyBcdFx0fTtcclxuLy8gICAgICAgICAvLyBjb25zb2xlLmxvZygkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSlcclxuLy8gICAgICAgICAvLyBjb25zb2xlLmxvZygkKGRvY3VtZW50KS5oZWlnaHQoKSlcclxuLy8gXHRcdGlmKCAkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSA+ICgkKGRvY3VtZW50KS5oZWlnaHQoKSAtIGJvdHRvbU9mZnNldCkgJiYgISQoJ2JvZHknKS5oYXNDbGFzcygnbG9hZGluZycpKXtcclxuLy8gXHRcdFx0JC5hamF4KHtcclxuLy8gXHRcdFx0XHR1cmw6YWpheHVybCxcclxuLy8gXHRcdFx0XHRkYXRhOmRhdGEsXHJcbi8vIFx0XHRcdFx0dHlwZTonUE9TVCcsXHJcbi8vIFx0XHRcdFx0YmVmb3JlU2VuZDogZnVuY3Rpb24oIHhocil7XHJcbi8vIFx0XHRcdFx0XHQkKCdib2R5JykuYWRkQ2xhc3MoJ2xvYWRpbmcnKTtcclxuLy8gXHRcdFx0XHR9LFxyXG4vLyBcdFx0XHRcdHN1Y2Nlc3M6ZnVuY3Rpb24oZGF0YSl7XHJcbi8vIFx0XHRcdFx0XHRpZiggZGF0YSApIHsgXHJcbi8vIFx0XHRcdFx0XHRcdCQoJyN0cnVlX2xvYWRtb3JlJykuYmVmb3JlKGRhdGEpO1xyXG4vLyBcdFx0XHRcdFx0XHQkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcnKTtcclxuLy8gXHRcdFx0XHRcdFx0Y3VycmVudF9wYWdlKys7XHJcbi8vIFx0XHRcdFx0XHR9XHJcbi8vIFx0XHRcdFx0fVxyXG4vLyBcdFx0XHR9KTtcclxuLy8gXHRcdH1cclxuLy8gXHR9KTtcclxuLy8gfSk7IiwidHJ5IHtcclxuICAgIGNvbnN0IGJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvcnRfX2l0ZW1zXCIpO1xyXG4gICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsXCIpO1xyXG4gICAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGlhbG9nXCIpO1xyXG4gICAgY29uc3QgYmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19ibG9ja1wiKTtcclxuXHJcblxyXG5cclxuICAgIC8vIGJ0bnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBidG5zLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgIGlmICggZS50YXJnZXQuY2xvc2VzdChcIi50b3J0X19pdGVtXCIpKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xyXG4gICAgICAgICAgICBtb2RhbC5zdHlsZS50cmFuc2l0aW9uID0gXCJhbGwgMXNcIjtcclxuICAgICAgICAgICAgbW9kYWwuc3R5bGUub3ZlcmZsb3cgPSBcImF1dG9cIjtcclxuICAgICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQuY2xvc2VzdChcIi50b3J0X19pdGVtXCIpO1xyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX2luZm9Ub3J0XCIpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGBcclxuICAgICAgICAgICAgICAgIDxoMiBjbGFzcz1cIm1vZGFsX190aXRsZVwiPtCe0L3Qu9Cw0LnQvSDQt9Cw0LrQsNC3INGC0L7RgNGC0LA8L2gyPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19pbmZvXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19pbWctYmxvY2tcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9XCIke3RhcmdldC5kYXRhc2V0LmltZ31cIiBhbHQ9XCJ0b3J0XCIgY2xhc3M9XCJtb2RhbF9faW1nXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19kZXNjcmlwdGlvblwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aDUgY2xhc3M9XCJtb2RhbF9fbmFtZVwiPiR7dGFyZ2V0LmRhdGFzZXQubmFtZVRvcnR9PC9oNT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJtb2RhbF9fdGV4dFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHt0YXJnZXQuZGF0YXNldC5kZXNjcmlwdGlvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX2JvdHRvbVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9fbGluZVwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9fb3Bpc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX2dyYW1cIj4ke3RhcmdldC5kYXRhc2V0LmtnfSDQutCzLjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX3ByaWNlXCI+JHt0YXJnZXQuZGF0YXNldC5ydWJ9IOKCvTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIGA7XHJcbiAgICAgICAgICAgIGJsb2NrLmFwcGVuZChlbGVtZW50KTtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXRUb3J0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgICAgICBpbnB1dFRvcnQuY2xhc3NMaXN0LmFkZChcImlucHV0X19oaWRkZW5cIik7XHJcbiAgICAgICAgICAgIGlucHV0VG9ydC52YWx1ZSA9IHRhcmdldC5kYXRhc2V0Lm5hbWVUb3J0O1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhpZGRlbl9fbGFiZWxcIikuYXBwZW5kKGlucHV0VG9ydCk7XHJcbiAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KVxyXG4gICAgLy8gfSlcclxuXHJcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLnRyYW5zaXRpb24gPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5mb1RvcnRcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGlkZGVuX19sYWJlbFwiKS5xdWVyeVNlbGVjdG9yKFwiLmlucHV0X19oaWRkZW5cIikucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufSBjYXRjaCB7fSIsInRyeSB7XHJcbiAgICBjb25zdCBjb250cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29udFwiKTtcclxuICAgIGNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25cIikucXVlcnlTZWxlY3RvckFsbChcIi5hcHBsaWNhdGlvbi1pbnB1dFwiKTtcclxuXHJcblxyXG5cclxuICAgIGNvbnRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KFwiLmNvbnRcIik7XHJcbiAgICAgICAgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFwiKS5mb2N1cygpO1xyXG4gICAgICAgIHRhcmdldC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBpbnB1dHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldC52YWx1ZS50cmltKCkgPT0gJycpXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn0gY2F0Y2gge31cclxuXHJcbiIsInRyeSB7XHJcbiAgICBjb25zdCBsYWJlbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmFwcGxpY2F0aW9uX19sYWJlbFwiKTtcclxuXHJcbiAgICBsYWJlbHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgb2xkQ2hlY2tCb3hzID0gZS50YXJnZXQuY2xvc2VzdChcIi5hcHBsaWNhdGlvbl9fbGFiZWxcIikucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3hcIilcclxuICAgICAgICAgICAgY29uc3QgbmV3Q2hlY2tCb3hzID0gZS50YXJnZXQuY2xvc2VzdChcIi5hcHBsaWNhdGlvbl9fbGFiZWxcIikucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3gtYmxvY2tcIilcclxuXHJcbiAgICAgICAgICAgIGlmICghb2xkQ2hlY2tCb3hzLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHJ1ZVwiKVxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3gtYmxvY2tcIikuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJhcHBsaWNhdGlvbl9fY2hlY2tib3gtYmxvY2stYWN0aXZlXCIpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3hcIikuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWwuY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIG5ld0NoZWNrQm94cy5jbGFzc0xpc3QuYWRkKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICAgICAgb2xkQ2hlY2tCb3hzLmNoZWNrZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gaWYgKG9sZENoZWNrQm94cy5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBvbGRDaGVja0JveHMuY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyAgICAgbmV3Q2hlY2tCb3hzLmNsYXNzTGlzdC5yZW1vdmUoXCJhcHBsaWNhdGlvbl9fY2hlY2tib3gtYmxvY2stYWN0aXZlXCIpXHJcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICBvbGRDaGVja0JveHMuY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vICAgICBuZXdDaGVja0JveHMuY2xhc3NMaXN0LmFkZChcImFwcGxpY2F0aW9uX19jaGVja2JveC1ibG9jay1hY3RpdmVcIilcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59IGNhdGNoIHt9IiwiaWYgKHdpbmRvdy5Ob2RlTGlzdCAmJiAhTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2gpIHtcclxuICAgIE5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdGhpc0FyZyA9IHRoaXNBcmcgfHwgd2luZG93O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHRoaXNbaV0sIGksIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxudHJ5IHtcclxuICAgIC8vIGlmICghQXJyYXkucHJvdG90eXBlLmZvckVhY2gpIHtcclxuXHJcbiAgICAvLyAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICB2YXIgVCwgaztcclxuICAgICAgXHJcbiAgICAvLyAgICAgICBpZiAodGhpcyA9PSBudWxsKSB7XHJcbiAgICAvLyAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyB0aGlzIGlzIG51bGwgb3Igbm90IGRlZmluZWQnKTtcclxuICAgIC8vICAgICAgIH1cclxuICAgICAgXHJcbiAgICAvLyAgICAgICAvLyAxLiDQn9C+0LvQvtC20LjQvCBPINGA0LDQstC90YvQvCDRgNC10LfRg9C70YzRgtCw0YLRgyDQstGL0LfQvtCy0LAgVG9PYmplY3QgcGFzc2luZyB0aGUgfHRoaXN8IHZhbHVlIGFzIHRoZSBhcmd1bWVudC5cclxuICAgIC8vICAgICAgIHZhciBPID0gT2JqZWN0KHRoaXMpO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDIuINCf0L7Qu9C+0LbQuNC8IGxlblZhbHVlINGA0LDQstC90YvQvCDRgNC10LfRg9C70YzRgtCw0YLRgyDQstGL0LfQvtCy0LAg0LLQvdGD0YLRgNC10L3QvdC10LPQviDQvNC10YLQvtC00LAgR2V0INC+0LHRitC10LrRgtCwIE8g0YEg0LDRgNCz0YPQvNC10L3RgtC+0LwgXCJsZW5ndGhcIi5cclxuICAgIC8vICAgICAgIC8vIDMuINCf0L7Qu9C+0LbQuNC8IGxlbiDRgNCw0LLQvdGL0LwgVG9VaW50MzIobGVuVmFsdWUpLlxyXG4gICAgLy8gICAgICAgdmFyIGxlbiA9IE8ubGVuZ3RoID4+PiAwO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDQuINCV0YHQu9C4IElzQ2FsbGFibGUoY2FsbGJhY2spINGA0LDQstC10L0gZmFsc2UsINCy0YvQutC40L3QtdC8INC40YHQutC70Y7Rh9C10L3QuNC1IFR5cGVFcnJvci5cclxuICAgIC8vICAgICAgIC8vINCh0LzQvtGC0YDQuNGC0LU6IGh0dHA6Ly9lczUuZ2l0aHViLmNvbS8jeDkuMTFcclxuICAgIC8vICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuICAgIC8vICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGNhbGxiYWNrICsgJyBpcyBub3QgYSBmdW5jdGlvbicpO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDUuINCV0YHQu9C4IHRoaXNBcmcg0L/RgNC40YHRg9GC0YHRgtCy0YPQtdGCLCDQv9C+0LvQvtC20LjQvCBUINGA0LDQstC90YvQvCB0aGlzQXJnOyDQuNC90LDRh9C1INC/0L7Qu9C+0LbQuNC8IFQg0YDQsNCy0L3Ri9C8IHVuZGVmaW5lZC5cclxuICAgIC8vICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xyXG4gICAgLy8gICAgICAgICBUID0gdGhpc0FyZztcclxuICAgIC8vICAgICAgIH1cclxuICAgICAgXHJcbiAgICAvLyAgICAgICAvLyA2LiDQn9C+0LvQvtC20LjQvCBrINGA0LDQstC90YvQvCAwXHJcbiAgICAvLyAgICAgICBrID0gMDtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAvLyA3LiDQn9C+0LrQsCBrIDwgbGVuLCDQsdGD0LTQtdC8INC/0L7QstGC0L7RgNGP0YLRjFxyXG4gICAgLy8gICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAgIHZhciBrVmFsdWU7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgICAvLyBhLiDQn9C+0LvQvtC20LjQvCBQayDRgNCw0LLQvdGL0LwgVG9TdHJpbmcoaykuXHJcbiAgICAvLyAgICAgICAgIC8vICAg0K3RgtC+INC90LXRj9Cy0L3QvtC1INC/0YDQtdC+0LHRgNCw0LfQvtCy0LDQvdC40LUg0LTQu9GPINC70LXQstC+0YHRgtC+0YDQvtC90L3QtdCz0L4g0L7Qv9C10YDQsNC90LTQsCDQsiDQvtC/0LXRgNCw0YLQvtGA0LUgaW5cclxuICAgIC8vICAgICAgICAgLy8gYi4g0J/QvtC70L7QttC40Lwga1ByZXNlbnQg0YDQsNCy0L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtGDINCy0YvQt9C+0LLQsCDQstC90YPRgtGA0LXQvdC90LXQs9C+INC80LXRgtC+0LTQsCBIYXNQcm9wZXJ0eSDQvtCx0YrQtdC60YLQsCBPINGBINCw0YDQs9GD0LzQtdC90YLQvtC8IFBrLlxyXG4gICAgLy8gICAgICAgICAvLyAgINCt0YLQvtGCINGI0LDQsyDQvNC+0LbQtdGCINCx0YvRgtGMINC+0LHRitC10LTQuNC90ZHQvSDRgSDRiNCw0LPQvtC8IGNcclxuICAgIC8vICAgICAgICAgLy8gYy4g0JXRgdC70Lgga1ByZXNlbnQg0YDQsNCy0LXQvSB0cnVlLCDRgtC+XHJcbiAgICAvLyAgICAgICAgIGlmIChrIGluIE8pIHtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAgICAgLy8gaS4g0J/QvtC70L7QttC40Lwga1ZhbHVlINGA0LDQstC90YvQvCDRgNC10LfRg9C70YzRgtCw0YLRgyDQstGL0LfQvtCy0LAg0LLQvdGD0YLRgNC10L3QvdC10LPQviDQvNC10YLQvtC00LAgR2V0INC+0LHRitC10LrRgtCwIE8g0YEg0LDRgNCz0YPQvNC10L3RgtC+0LwgUGsuXHJcbiAgICAvLyAgICAgICAgICAga1ZhbHVlID0gT1trXTtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAgICAgLy8gaWkuINCS0YvQt9C+0LLQtdC8INCy0L3Rg9GC0YDQtdC90L3QuNC5INC80LXRgtC+0LQgQ2FsbCDRhNGD0L3QutGG0LjQuCBjYWxsYmFjayDRgSDQvtCx0YrQtdC60YLQvtC8IFQg0LIg0LrQsNGH0LXRgdGC0LLQtSDQt9C90LDRh9C10L3QuNGPIHRoaXMg0LhcclxuICAgIC8vICAgICAgICAgICAvLyDRgdC/0LjRgdC60L7QvCDQsNGA0LPRg9C80LXQvdGC0L7Qsiwg0YHQvtC00LXRgNC20LDRidC40Lwga1ZhbHVlLCBrINC4IE8uXHJcbiAgICAvLyAgICAgICAgICAgY2FsbGJhY2suY2FsbChULCBrVmFsdWUsIGssIE8pO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIC8vIGQuINCj0LLQtdC70LjRh9C40LwgayDQvdCwIDEuXHJcbiAgICAvLyAgICAgICAgIGsrKztcclxuICAgIC8vICAgICAgIH1cclxuICAgIC8vICAgICAgIC8vIDguINCS0LXRgNC90ZHQvCB1bmRlZmluZWQuXHJcbiAgICAvLyAgICAgfTtcclxuICAgIC8vICAgfVxyXG4gICAgICAoZnVuY3Rpb24oRUxFTUVOVCkge1xyXG4gICAgICAgIEVMRU1FTlQubWF0Y2hlcyA9IEVMRU1FTlQubWF0Y2hlcyB8fCBFTEVNRU5ULm1vek1hdGNoZXNTZWxlY3RvciB8fCBFTEVNRU5ULm1zTWF0Y2hlc1NlbGVjdG9yIHx8IEVMRU1FTlQub01hdGNoZXNTZWxlY3RvciB8fCBFTEVNRU5ULndlYmtpdE1hdGNoZXNTZWxlY3RvcjtcclxuICAgICAgICBFTEVNRU5ULmNsb3Nlc3QgPSBFTEVNRU5ULmNsb3Nlc3QgfHwgZnVuY3Rpb24gY2xvc2VzdChzZWxlY3Rvcikge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMpIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tYXRjaGVzKHNlbGVjdG9yKSkgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnRFbGVtZW50KSB7cmV0dXJuIG51bGx9XHJcbiAgICAgICAgICAgIGVsc2UgcmV0dXJuIHRoaXMucGFyZW50RWxlbWVudC5jbG9zZXN0KHNlbGVjdG9yKVxyXG4gICAgICAgICAgfTtcclxuICAgIH0oRWxlbWVudC5wcm90b3R5cGUpKTtcclxuICAgIGNvbnN0IHdpZHRoID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX3dyYXBwZXJcIikpLndpZHRoO1xyXG4gICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX193cmFwcGVyXCIpO1xyXG4gICAgY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNsaWRlcl9faXRlbVwiKTtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fY29udGVudFwiKTtcclxuICAgIGNvbnN0IHByZXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fbGVmdFwiKTtcclxuICAgIGNvbnN0IG5leHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fcmlnaHRcIik7XHJcbiAgICBjb25zdCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlclwiKTtcclxuXHJcbmxldCBjb3VudCA9IDE7XHJcbmZ1bmN0aW9uIGFkZERvdHMoKSB7XHJcbiAgICBjb25zdCBkb3RzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGRvdHMuY2xhc3NMaXN0LmFkZChcInNsaWRlcl9fZG90c1wiKTtcclxuXHJcblxyXG4gICAgZWxlbWVudHMuZm9yRWFjaCgoZWwsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgY29uc3QgZG90ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxyXG4gICAgICAgIGRvdC5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3RcIik7XHJcbiAgICAgICAgZG90LnNldEF0dHJpYnV0ZShcImRhdGEtY291bnRcIiwgaW5kZXggKyAxKVxyXG4gICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xyXG4gICAgICAgICAgICBkb3QuY2xhc3NMaXN0LmFkZChcInNsaWRlcl9fZG90LWFjdGl2ZVwiKTsgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBkb3RzLmFwcGVuZENoaWxkKGRvdCk7XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIFxyXG4gICAgLy8gfVxyXG5cclxuXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlclwiKS5hcHBlbmRDaGlsZChkb3RzKTtcclxufVxyXG5hZGREb3RzKCk7XHJcblxyXG5cclxuY29udGVudC5zdHlsZS53aWR0aCA9IGVsZW1lbnRzLmxlbmd0aCAqIHBhcnNlSW50KHdpZHRoKSArIFwicHhcIjtcclxuXHJcbm5leHQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGdvTmV4dCk7XHJcbnByZXYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGdvUHJldik7XHJcblxyXG5sZXQgaW50ZXJ2YWw7XHJcblxyXG5mdW5jdGlvbiBzdGFydEludGVydmFsKCkge1xyXG4gICAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChnb05leHQsIDYwMDApO1xyXG59XHJcbnN0YXJ0SW50ZXJ2YWwoKTtcclxuXHJcbndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKCkgPT4ge1xyXG4gICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XHJcbn0pXHJcblxyXG53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsICgpID0+IHtcclxuICAgIHN0YXJ0SW50ZXJ2YWwoKTtcclxufSlcclxuXHJcbnNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKFwiLnNsaWRlcl9fZG90XCIpLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4gY2hhbmdlRG90cyhlLCBudWxsKSlcclxufSlcclxuXHJcbmZ1bmN0aW9uIGNoYW5nZURvdHMoZSwgY29sb3IpIHtcclxuICAgIGlmIChlKSB7XHJcbiAgICAgICAgc2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19kb3RcIikuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZChcInNsaWRlcl9fZG90LWFjdGl2ZVwiKTtcclxuICAgICAgICBjb25zdCBpbmRleCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtY291bnRcIik7XHJcblxyXG4gICAgICAgIGNvdW50ID0gaW5kZXg7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gKGNvdW50ICogcGFyc2VJbnQod2lkdGgpKSAtIHBhcnNlSW50KHdpZHRoKTtcclxuICAgICAgICBjb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3Jlc3VsdH1weClgO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjb2xvcikge1xyXG4gICAgICAgIHNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKFwiLnNsaWRlcl9fZG90XCIpLmZvckVhY2goKGl0ZW0sIGluZGV4KT0+IHtcclxuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXgrMSA9PT0gY291bnQpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChcInNsaWRlcl9fZG90LWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnb05leHQoKSB7XHJcbiAgICBpZiAoY291bnQgPT09IGVsZW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgIGNvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoMClgO1xyXG4gICAgICAgIGNvdW50ID0gMTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY291bnQrKztcclxuICAgICAgICBjb25zdCByZXN1bHQgPSAoY291bnQgLSAxKSAqIHBhcnNlSW50KHdpZHRoKTtcclxuICAgICAgICBjb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3Jlc3VsdH1weClgO1xyXG4gICAgfVxyXG4gICAgY2hhbmdlRG90cyhudWxsLCBcImNoYW5nZUNvbG9yXCIpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdvUHJldigpIHtcclxuICAgIGlmIChjb3VudCA9PT0gMSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9KCAoZWxlbWVudHMubGVuZ3RoIC0gMSkgKiBwYXJzZUludCh3aWR0aCkpICsgXCJweFwiO1xyXG4gICAgICAgIGNvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7cmVzdWx0fSlgO1xyXG4gICAgICAgIGNvdW50ID0gZWxlbWVudHMubGVuZ3RoO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb3VudC0tO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IChjb3VudCAqIHBhcnNlSW50KHdpZHRoKSkgLSBwYXJzZUludCh3aWR0aCk7XHJcbiAgICAgICAgY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtyZXN1bHR9cHgpYDtcclxuICAgIH1cclxuICAgIGNoYW5nZURvdHMobnVsbCwgXCJjaGFuZ2VDb2xvclwiKVxyXG59XHJcbn1cclxuXHJcbmNhdGNoIHt9Il19
