"use strict";window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var c=0;c<this.length;c++)e.call(t,this[c],c,this)});var items=document.querySelectorAll(".cake__item");[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),c=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;c.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(c)}})}),function(){var e=[window.Element,window.CharacterData,window.DocumentType],t=[];e.forEach(function(e){e&&t.push(e.prototype)}),t.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}();try{var btn=document.querySelector(".menu__menu"),block=document.querySelector(".menu__list");btn.addEventListener("click",function(){btn.classList.toggle("menu__menu-active"),btn.classList.contains("menu__menu-active")?block.style.display="block":block.style.display="none"})}catch(e){}try{items.forEach(function(e){e.addEventListener("mouseover",function(e){var t,c=e.target.closest(".cake__item");if(c&&!c.querySelector(".cake__info")){switch(c.dataset.element){case"1":t="cake__goRight";break;case"2":t="cake__goCenter";break;case"3":t="cake__goLeft"}var a=document.createElement("div");a.classList.add("cake__info",t),console.log(a),a.innerHTML='\n                <h3 class="cake__title">'.concat(c.dataset.name,'</h3>\n                <p class="cake__description">').concat(c.dataset.info,'</p>\n                <div class="cake__footer">\n                <span class="cake__gram">').concat(c.dataset.gramm,'г.</span>\n                <span class="cake__price">').concat(c.dataset.price,"Р</span>\n                "),c.append(a)}})}),items.forEach(function(e){e.addEventListener("mouseleave",function(e){document.querySelector(".cake__info").remove()})})}catch(e){}try{var checbox=document.querySelector(".application__label-checkbox"),button=document.querySelector(".application__submit");checbox.addEventListener("click",function(e){var t=checbox.querySelector(".application__checkbox-bad"),c=checbox.querySelector(".application__checkbox-bad-block");t.checked?(t.checked=!1,c.classList.remove("application__checkbox-bad-block-active"),button.classList.add("modal__disabled"),button.classList.remove("modal__submit")):(t.checked=!0,c.classList.add("application__checkbox-bad-block-active"),button.classList.remove("modal__disabled"),button.classList.add("modal__submit"))})}catch(e){}document.querySelectorAll("form").forEach(function(e){e.addEventListener("submit",function(e){e.preventDefault()})});try{var checkbox=document.querySelector(".modal__checkbox"),btnSubmit=document.querySelector(".modal__button"),applicationCheckBox=document.querySelector(".application__checkbox-bad"),applicationSubmit=document.querySelector(".application__submit");try{checkbox.addEventListener("change",function(){checkbox.checked?(btnSubmit.classList.remove("modal__disabled"),btnSubmit.classList.add("modal__submit")):(btnSubmit.classList.add("modal__disabled"),btnSubmit.classList.remove("modal__submit"))})}catch(e){}try{applicationCheckBox.addEventListener("change",function(e){applicationCheckBox.checked?(applicationSubmit.classList.remove("modal__disabled"),applicationSubmit.classList.add("modal__submit")):(applicationSubmit.classList.add("modal__disabled"),applicationSubmit.classList.remove("modal__submit"))})}catch(e){}}catch(e){}try{document.querySelector(".menu-icon").addEventListener("click",function(e){e.target.closest(".menu-icon").classList.toggle("clicked"),document.querySelector(".menu-icon").classList.contains("clicked")?document.querySelector(".header__list-hamburger").classList.add("active-list","header__list-hamburger-animate"):document.querySelector(".header__list-hamburger").classList.remove("active-list")})}catch(e){}try{var iframe=document.createElement("iframe")}catch(e){}try{var btns=document.querySelectorAll(".tort__click"),modal=document.querySelector(".modal"),dialog=document.querySelector(".modal__dialog"),_block=document.querySelector(".modal__block");btns.forEach(function(e){e.addEventListener("click",function(e){document.body.style.overflow="hidden",modal.style.transition="all 1s",modal.style.overflow="auto",modal.classList.add("modal-active");var t=e.target.closest(".tort__item"),c=document.createElement("div");c.classList.add("modal__infoTort"),c.innerHTML='\n                <h2 class="modal__title">Онлайн заказ торта</h2>\n                <div class="modal__info">\n                    <div class="modal__img-block">\n                        <img src="'.concat(t.dataset.img,'" alt="tort" class="modal__img">\n                    </div>\n                    <div class="modal__description">\n                        <h5 class="modal__name">').concat(t.dataset.nameTort,'</h5>\n                        <p class="modal__text">\n                            ').concat(t.dataset.description,'\n                        </p>\n                    </div>\n                </div>\n                <div class="modal__bottom">\n                    <div class="modal__line"></div>\n                    <div class="modal__opis">\n                        <div class="modal__gram">').concat(t.dataset.kg,' кг.</div>\n                        <div class="modal__price">').concat(t.dataset.rub," ₽</div>\n                    </div>\n                </div>\n            "),_block.append(c);var a=document.createElement("input");a.classList.add("input__hidden"),a.value=t.dataset.nameTort,document.querySelector(".hidden__label").append(a)})}),modal.addEventListener("click",function(e){e.target.classList.contains("modal")&&(document.body.style.overflow="",modal.style.transition="none",modal.classList.remove("modal-active"),modal.querySelector(".modal__infoTort").remove(),document.querySelector(".hidden__label").querySelector(".input__hidden").remove())})}catch(e){}try{var conts=document.querySelectorAll(".cont"),inputs=document.querySelector(".application").querySelectorAll(".application-input");conts.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.closest(".cont");t.querySelector("input").focus(),t.querySelector(".placeholder").style.display="none"})}),inputs.forEach(function(e){e.addEventListener("blur",function(e){""==e.target.value.trim()&&(e.target.parentElement.nextElementSibling.style.display="block")})})}catch(e){}try{var labels=document.querySelectorAll(".application__label");labels.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.closest(".application__label").querySelector(".application__checkbox"),c=e.target.closest(".application__label").querySelector(".application__checkbox-block");t.checked||(document.querySelectorAll(".application__checkbox").forEach(function(e){e.previousElementSibling.classList.remove("application__checkbox-block-active")}),c.classList.add("application__checkbox-block-active"))})})}catch(e){}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var c=0;c<this.length;c++)e.call(t,this[c],c,this)});try{var addDots=function(){var a=document.createElement("div");a.classList.add("slider__dots"),elements.forEach(function(e,t){var c=document.createElement("div");c.classList.add("slider__dot"),c.setAttribute("data-count",t+1),0===t&&c.classList.add("slider__dot-active"),a.appendChild(c)}),document.querySelector(".slider").appendChild(a)},startInterval=function(){interval=setInterval(goNext,6e3)},changeDots=function(e,t){var c,a;e&&(slider.querySelectorAll(".slider__dot").forEach(function(e){e.classList.remove("slider__dot-active")}),e.target.classList.add("slider__dot-active"),c=e.target.getAttribute("data-count"),a=(count=c)*parseInt(width)-parseInt(width),content.style.transform="translateX(-".concat(a,"px)")),t&&slider.querySelectorAll(".slider__dot").forEach(function(e,t){e.classList.remove("slider__dot-active"),t+1===count&&e.classList.add("slider__dot-active")})},goNext=function(){var e;count===elements.length?(content.style.transform="translateX(0)",count=1):(e=(++count-1)*parseInt(width),content.style.transform="translateX(-".concat(e,"px)")),changeDots(null,"changeColor")},goPrev=function(){var e,t;1===count?(e=(elements.length-1)*parseInt(width)+"px",content.style.transform="translateX(-".concat(e,")"),count=elements.length):(t=--count*parseInt(width)-parseInt(width),content.style.transform="translateX(-".concat(t,"px)")),changeDots(null,"changeColor")};!function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,e.closest=e.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null}}(Element.prototype);var interval,width=window.getComputedStyle(document.querySelector(".slider__wrapper")).width,wrapper=document.querySelector(".slider__wrapper"),elements=document.querySelectorAll(".slider__item"),content=document.querySelector(".slider__content"),prev=document.querySelector(".slider__left"),next=document.querySelector(".slider__right"),slider=document.querySelector(".slider"),count=1;addDots(),content.style.width=elements.length*parseInt(width)+"px",next.addEventListener("click",goNext),prev.addEventListener("click",goPrev),startInterval(),wrapper.addEventListener("mouseenter",function(){clearInterval(interval)}),wrapper.addEventListener("mouseleave",function(){startInterval()}),slider.querySelectorAll(".slider__dot").forEach(function(e){e.addEventListener("click",function(e){return changeDots(e,null)})})}catch(e){}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY2FyZGVvbi5qcyIsImNha2UuanMiLCJjaGVja2JveC5qcyIsImZldGNoLmpzIiwiZm9ybS5qcyIsImhhbWJ1cmdlci5qcyIsImlmcmFtZS5qcyIsIm1vZGFsLmpzIiwicGxhY2Vob2xkZXIuanMiLCJyYWRpb2J1dHRvbnMuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsid2luZG93IiwiTm9kZUxpc3QiLCJwcm90b3R5cGUiLCJmb3JFYWNoIiwiY2FsbGJhY2siLCJ0aGlzQXJnIiwiaSIsInRoaXMiLCJsZW5ndGgiLCJjYWxsIiwiaXRlbXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJFbGVtZW50IiwiRG9jdW1lbnQiLCJEb2N1bWVudEZyYWdtZW50IiwiaXRlbSIsImhhc093blByb3BlcnR5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJ2YWx1ZSIsImFyZ0FyciIsIkFycmF5Iiwic2xpY2UiLCJhcmd1bWVudHMiLCJkb2NGcmFnIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImFyZ0l0ZW0iLCJpc05vZGUiLCJOb2RlIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsIlN0cmluZyIsImFyciIsIkNoYXJhY3RlckRhdGEiLCJEb2N1bWVudFR5cGUiLCJhcmdzIiwicHVzaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImJ0biIsInF1ZXJ5U2VsZWN0b3IiLCJibG9jayIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjb250YWlucyIsInN0eWxlIiwiZGlzcGxheSIsIl91bnVzZWQiLCJlIiwidHJhbkNsYXNzIiwiYm9keSIsInRhcmdldCIsImNsb3Nlc3QiLCJkYXRhc2V0IiwiZWxlbWVudCIsImVsIiwiY3JlYXRlRWxlbWVudCIsImFkZCIsImNvbnNvbGUiLCJsb2ciLCJpbm5lckhUTUwiLCJjb25jYXQiLCJuYW1lIiwiaW5mbyIsImdyYW1tIiwicHJpY2UiLCJhcHBlbmQiLCJyZW1vdmUiLCJfdW51c2VkMiIsImNoZWNib3giLCJidXR0b24iLCJvbGRDaGVja0JveCIsIm5ld0NoZWNrQm94IiwiY2hlY2tlZCIsIl91bnVzZWQzIiwicHJldmVudERlZmF1bHQiLCJjaGVja2JveCIsImJ0blN1Ym1pdCIsImFwcGxpY2F0aW9uQ2hlY2tCb3giLCJhcHBsaWNhdGlvblN1Ym1pdCIsIl91bnVzZWQ0IiwiX3VudXNlZDUiLCJfdW51c2VkNiIsIl91bnVzZWQ3IiwiaWZyYW1lIiwiX3VudXNlZDgiLCJidG5zIiwibW9kYWwiLCJkaWFsb2ciLCJvdmVyZmxvdyIsInRyYW5zaXRpb24iLCJpbWciLCJuYW1lVG9ydCIsImRlc2NyaXB0aW9uIiwia2ciLCJydWIiLCJpbnB1dFRvcnQiLCJfdW51c2VkOSIsImNvbnRzIiwiaW5wdXRzIiwiZm9jdXMiLCJ0cmltIiwicGFyZW50RWxlbWVudCIsIm5leHRFbGVtZW50U2libGluZyIsIl91bnVzZWQxMCIsImxhYmVscyIsIm9sZENoZWNrQm94cyIsIm5ld0NoZWNrQm94cyIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJfdW51c2VkMTEiLCJhZGREb3RzIiwiZG90cyIsImVsZW1lbnRzIiwiaW5kZXgiLCJkb3QiLCJzZXRBdHRyaWJ1dGUiLCJzdGFydEludGVydmFsIiwiaW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImdvTmV4dCIsImNoYW5nZURvdHMiLCJjb2xvciIsInJlc3VsdCIsInNsaWRlciIsImdldEF0dHJpYnV0ZSIsImNvdW50IiwicGFyc2VJbnQiLCJ3aWR0aCIsImNvbnRlbnQiLCJ0cmFuc2Zvcm0iLCJnb1ByZXYiLCJFTEVNRU5UIiwibWF0Y2hlcyIsIm1vek1hdGNoZXNTZWxlY3RvciIsIm1zTWF0Y2hlc1NlbGVjdG9yIiwib01hdGNoZXNTZWxlY3RvciIsIndlYmtpdE1hdGNoZXNTZWxlY3RvciIsInNlbGVjdG9yIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsIndyYXBwZXIi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LFdBQ0EyRSxrQkFHQU8sT0FBQXBILGlCQUFBLGdCQUFBVCxRQUFBLFNBQUFhLEdBQ0FBLEVBQUE4QixpQkFBQSxRQUFBLFNBQUFPLEdBQUEsT0FBQXdFLFdBQUF4RSxFQUFBLFVBb0RBLE1BQUErRiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaWYgKHdpbmRvdy5Ob2RlTGlzdCAmJiAhTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2gpIHtcclxuICAgIE5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdGhpc0FyZyA9IHRoaXNBcmcgfHwgd2luZG93O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHRoaXNbaV0sIGksIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuY29uc3QgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNha2VfX2l0ZW1cIik7XHJcbihmdW5jdGlvbiAoYXJyKSB7XHJcbiAgICBhcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICBpZiAoaXRlbS5oYXNPd25Qcm9wZXJ0eSgnYXBwZW5kJykpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGl0ZW0sICdhcHBlbmQnLCB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXHJcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZCgpIHtcclxuICAgICAgICAgIHZhciBhcmdBcnIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLFxyXG4gICAgICAgICAgICBkb2NGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gIFxyXG4gICAgICAgICAgYXJnQXJyLmZvckVhY2goZnVuY3Rpb24gKGFyZ0l0ZW0pIHtcclxuICAgICAgICAgICAgdmFyIGlzTm9kZSA9IGFyZ0l0ZW0gaW5zdGFuY2VvZiBOb2RlO1xyXG4gICAgICAgICAgICBkb2NGcmFnLmFwcGVuZENoaWxkKGlzTm9kZSA/IGFyZ0l0ZW0gOiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShTdHJpbmcoYXJnSXRlbSkpKTtcclxuICAgICAgICAgIH0pO1xyXG4gIFxyXG4gICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZChkb2NGcmFnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSkoW0VsZW1lbnQucHJvdG90eXBlLCBEb2N1bWVudC5wcm90b3R5cGUsIERvY3VtZW50RnJhZ21lbnQucHJvdG90eXBlXSk7XHJcbiAgKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGFyciA9IFt3aW5kb3cuRWxlbWVudCwgd2luZG93LkNoYXJhY3RlckRhdGEsIHdpbmRvdy5Eb2N1bWVudFR5cGVdO1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICBcclxuICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgYXJncy5wdXNoKGl0ZW0ucHJvdG90eXBlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgXHJcbiAgICAvLyBmcm9tOmh0dHBzOi8vZ2l0aHViLmNvbS9qc2Vyei9qc19waWVjZS9ibG9iL21hc3Rlci9ET00vQ2hpbGROb2RlL3JlbW92ZSgpL3JlbW92ZSgpLm1kXHJcbiAgICAoZnVuY3Rpb24gKGFycikge1xyXG4gICAgICBhcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgIGlmIChpdGVtLmhhc093blByb3BlcnR5KCdyZW1vdmUnKSkge1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaXRlbSwgJ3JlbW92ZScsIHtcclxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KShhcmdzKTtcclxuICB9KSgpO1xyXG50cnkge1xyXG4gICAgY29uc3QgYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51X19tZW51XCIpXHJcbiAgICBjb25zdCBibG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudV9fbGlzdFwiKTtcclxuXHJcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZShcIm1lbnVfX21lbnUtYWN0aXZlXCIpO1xyXG4gICAgICAgIGlmIChidG4uY2xhc3NMaXN0LmNvbnRhaW5zKFwibWVudV9fbWVudS1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgYmxvY2suc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBibG9jay5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0gY2F0Y2gge30iLCJ0cnkge1xyXG5cclxuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBlID0+IHtcclxuICAgICAgICBjb25zdCBib2R5ID0gZS50YXJnZXQuY2xvc2VzdChcIi5jYWtlX19pdGVtXCIpO1xyXG4gICAgICAgIGlmIChib2R5KSB7XHJcbiAgICAgICAgICAgIGxldCB0cmFuQ2xhc3M7XHJcbiAgICAgICAgICAgIGlmICghYm9keS5xdWVyeVNlbGVjdG9yKFwiLmNha2VfX2luZm9cIikpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaChib2R5LmRhdGFzZXQuZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCIxXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbkNsYXNzID0gXCJjYWtlX19nb1JpZ2h0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjJcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuQ2xhc3MgPSBcImNha2VfX2dvQ2VudGVyXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiM1wiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5DbGFzcyA9IFwiY2FrZV9fZ29MZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJjYWtlX19pbmZvXCIsIHRyYW5DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlbCk7XHJcbiAgICAgICAgICAgICAgICBlbC5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XCJjYWtlX190aXRsZVwiPiR7Ym9keS5kYXRhc2V0Lm5hbWV9PC9oMz5cclxuICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwiY2FrZV9fZGVzY3JpcHRpb25cIj4ke2JvZHkuZGF0YXNldC5pbmZvfTwvcD5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjYWtlX19mb290ZXJcIj5cclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2FrZV9fZ3JhbVwiPiR7Ym9keS5kYXRhc2V0LmdyYW1tfdCzLjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2FrZV9fcHJpY2VcIj4ke2JvZHkuZGF0YXNldC5wcmljZX3QoDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIGA7XHJcbiAgICAgICAgICAgICAgICBib2R5LmFwcGVuZChlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSk7XHJcbml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGUgPT4geyBcclxuICAgICAgICAvLyBjb25zdCBpbWcgPSBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbmMoXCJjYWtlX19pdGVtLWltZ1wiKTtcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNha2VfX2luZm9cIikucmVtb3ZlKClcclxuXHJcbiAgICB9KVxyXG59KVxyXG59IGNhdGNoIHt9XHJcblxyXG4iLCJ0cnkge1xyXG4gICAgY29uc3QgY2hlY2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2xhYmVsLWNoZWNrYm94XCIpO1xyXG4gICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fc3VibWl0XCIpO1xyXG5cclxuICAgIGNoZWNib3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb2xkQ2hlY2tCb3ggPSBjaGVjYm94LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94LWJhZFwiKTtcclxuICAgICAgICBjb25zdCBuZXdDaGVja0JveCA9IGNoZWNib3gucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkLWJsb2NrXCIpO1xyXG5cclxuICAgICAgICBpZiAob2xkQ2hlY2tCb3guY2hlY2tlZCkge1xyXG4gICAgICAgICAgICBvbGRDaGVja0JveC5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG5ld0NoZWNrQm94LmNsYXNzTGlzdC5yZW1vdmUoXCJhcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkLWJsb2NrLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvbGRDaGVja0JveC5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgbmV3Q2hlY2tCb3guY2xhc3NMaXN0LmFkZChcImFwcGxpY2F0aW9uX19jaGVja2JveC1iYWQtYmxvY2stYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fc3VibWl0XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn0gY2F0Y2gge30iLCJkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiZm9ybVwiKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSlcclxufSkiLCJ0cnkge1xyXG4gICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jaGVja2JveFwiKTtcclxuICAgIGNvbnN0IGJ0blN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIGNvbnN0IGFwcGxpY2F0aW9uQ2hlY2tCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWRcIik7XHJcbiAgICBjb25zdCBhcHBsaWNhdGlvblN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX3N1Ym1pdFwiKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY2hlY2tib3guY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgYnRuU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIGJ0blN1Ym1pdC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9IGNhdGNoe31cclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXBwbGljYXRpb25DaGVja0JveC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbkNoZWNrQm94LmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvblN1Ym1pdC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uU3VibWl0LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvblN1Ym1pdC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9IGNhdGNoIHt9XHJcbn0gY2F0Y2gge31cclxuXHJcblxyXG4iLCJ0cnkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51LWljb25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgZS50YXJnZXQuY2xvc2VzdChcIi5tZW51LWljb25cIikuY2xhc3NMaXN0LnRvZ2dsZShcImNsaWNrZWRcIik7XHJcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudS1pY29uXCIpLmNsYXNzTGlzdC5jb250YWlucyhcImNsaWNrZWRcIikpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2xpc3QtaGFtYnVyZ2VyXCIpLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtbGlzdFwiLCBcImhlYWRlcl9fbGlzdC1oYW1idXJnZXItYW5pbWF0ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlcl9fbGlzdC1oYW1idXJnZXJcIikuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZS1saXN0XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn0gY2F0Y2gge30iLCJ0cnkge1xyXG4gICAgbGV0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XHJcbiAgICBcclxuICAgIC8vIGh0dHBzOi8veWFuZGV4LnJ1L21hcC13aWRnZXQvdjEvP3VtPWNvbnN0cnVjdG9yJTNBOTI2MzZiMzQ5ZWIwNmYwY2M1YjlkNDMyM2VhMGYxZWIwMzFkNjM5OTkyNGUwZTBjMTcyODg2YjU3YjVjMWE3OSZhbXA7c291cmNlPWNvbnN0cnVjdG9yXHJcbn1jYXRjaCB7fSIsInRyeSB7XHJcbiAgICBjb25zdCBidG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50b3J0X19jbGlja1wiKTtcclxuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbFwiKTtcclxuICAgIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2RpYWxvZ1wiKTtcclxuICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYmxvY2tcIik7XHJcblxyXG5cclxuXHJcbiAgICBidG5zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLnRyYW5zaXRpb24gPSBcImFsbCAxc1wiO1xyXG4gICAgICAgICAgICBtb2RhbC5zdHlsZS5vdmVyZmxvdyA9IFwiYXV0b1wiO1xyXG4gICAgICAgICAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWwtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KFwiLnRvcnRfX2l0ZW1cIik7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9faW5mb1RvcnRcIik7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICAgICAgPGgyIGNsYXNzPVwibW9kYWxfX3RpdGxlXCI+0J7QvdC70LDQudC9INC30LDQutCw0Lcg0YLQvtGA0YLQsDwvaDI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX2luZm9cIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX2ltZy1ibG9ja1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz1cIiR7dGFyZ2V0LmRhdGFzZXQuaW1nfVwiIGFsdD1cInRvcnRcIiBjbGFzcz1cIm1vZGFsX19pbWdcIj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX2Rlc2NyaXB0aW9uXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzcz1cIm1vZGFsX19uYW1lXCI+JHt0YXJnZXQuZGF0YXNldC5uYW1lVG9ydH08L2g1PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cIm1vZGFsX190ZXh0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke3RhcmdldC5kYXRhc2V0LmRlc2NyaXB0aW9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9fYm90dG9tXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19saW5lXCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19vcGlzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9fZ3JhbVwiPiR7dGFyZ2V0LmRhdGFzZXQua2d9INC60LMuPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9fcHJpY2VcIj4ke3RhcmdldC5kYXRhc2V0LnJ1Yn0g4oK9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgYDtcclxuICAgICAgICAgICAgYmxvY2suYXBwZW5kKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dFRvcnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgIGlucHV0VG9ydC5jbGFzc0xpc3QuYWRkKFwiaW5wdXRfX2hpZGRlblwiKTtcclxuICAgICAgICAgICAgaW5wdXRUb3J0LnZhbHVlID0gdGFyZ2V0LmRhdGFzZXQubmFtZVRvcnQ7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGlkZGVuX19sYWJlbFwiKS5hcHBlbmQoaW5wdXRUb3J0KTtcclxuXHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcblxyXG4gICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcIlwiO1xyXG4gICAgICAgICAgICBtb2RhbC5zdHlsZS50cmFuc2l0aW9uID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2luZm9Ub3J0XCIpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhpZGRlbl9fbGFiZWxcIikucXVlcnlTZWxlY3RvcihcIi5pbnB1dF9faGlkZGVuXCIpLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn0gY2F0Y2gge30iLCJ0cnkge1xyXG4gICAgY29uc3QgY29udHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNvbnRcIik7XHJcbiAgICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uXCIpLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYXBwbGljYXRpb24taW5wdXRcIik7XHJcblxyXG5cclxuXHJcbiAgICBjb250cy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQuY2xvc2VzdChcIi5jb250XCIpO1xyXG4gICAgICAgIHRhcmdldC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIikuZm9jdXMoKTtcclxuICAgICAgICB0YXJnZXQucXVlcnlTZWxlY3RvcihcIi5wbGFjZWhvbGRlclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcblxyXG4gICAgaW5wdXRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZS50YXJnZXQudmFsdWUudHJpbSgpID09ICcnKVxyXG4gICAgICAgICAgICBlLnRhcmdldC5wYXJlbnRFbGVtZW50Lm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59IGNhdGNoIHt9XHJcblxyXG4iLCJ0cnkge1xyXG4gICAgY29uc3QgbGFiZWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcHBsaWNhdGlvbl9fbGFiZWxcIik7XHJcblxyXG4gICAgbGFiZWxzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG9sZENoZWNrQm94cyA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuYXBwbGljYXRpb25fX2xhYmVsXCIpLnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94XCIpXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0NoZWNrQm94cyA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuYXBwbGljYXRpb25fX2xhYmVsXCIpLnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrXCIpXHJcblxyXG4gICAgICAgICAgICBpZiAoIW9sZENoZWNrQm94cy5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveFwiKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZy5jbGFzc0xpc3QucmVtb3ZlKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIG5ld0NoZWNrQm94cy5jbGFzc0xpc3QuYWRkKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAob2xkQ2hlY2tCb3hzLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgLy8gICAgIG9sZENoZWNrQm94cy5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vICAgICBuZXdDaGVja0JveHMuY2xhc3NMaXN0LnJlbW92ZShcImFwcGxpY2F0aW9uX19jaGVja2JveC1ibG9jay1hY3RpdmVcIilcclxuICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgIG9sZENoZWNrQm94cy5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gICAgIG5ld0NoZWNrQm94cy5jbGFzc0xpc3QuYWRkKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn0gY2F0Y2gge30iLCJpZiAod2luZG93Lk5vZGVMaXN0ICYmICFOb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCkge1xyXG4gICAgTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcclxuICAgICAgICB0aGlzQXJnID0gdGhpc0FyZyB8fCB3aW5kb3c7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpc1tpXSwgaSwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG50cnkge1xyXG4gICAgLy8gaWYgKCFBcnJheS5wcm90b3R5cGUuZm9yRWFjaCkge1xyXG5cclxuICAgIC8vICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIHZhciBULCBrO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIGlmICh0aGlzID09IG51bGwpIHtcclxuICAgIC8vICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignIHRoaXMgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDEuINCf0L7Qu9C+0LbQuNC8IE8g0YDQsNCy0L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtGDINCy0YvQt9C+0LLQsCBUb09iamVjdCBwYXNzaW5nIHRoZSB8dGhpc3wgdmFsdWUgYXMgdGhlIGFyZ3VtZW50LlxyXG4gICAgLy8gICAgICAgdmFyIE8gPSBPYmplY3QodGhpcyk7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gMi4g0J/QvtC70L7QttC40LwgbGVuVmFsdWUg0YDQsNCy0L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtGDINCy0YvQt9C+0LLQsCDQstC90YPRgtGA0LXQvdC90LXQs9C+INC80LXRgtC+0LTQsCBHZXQg0L7QsdGK0LXQutGC0LAgTyDRgSDQsNGA0LPRg9C80LXQvdGC0L7QvCBcImxlbmd0aFwiLlxyXG4gICAgLy8gICAgICAgLy8gMy4g0J/QvtC70L7QttC40LwgbGVuINGA0LDQstC90YvQvCBUb1VpbnQzMihsZW5WYWx1ZSkuXHJcbiAgICAvLyAgICAgICB2YXIgbGVuID0gTy5sZW5ndGggPj4+IDA7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gNC4g0JXRgdC70LggSXNDYWxsYWJsZShjYWxsYmFjaykg0YDQsNCy0LXQvSBmYWxzZSwg0LLRi9C60LjQvdC10Lwg0LjRgdC60LvRjtGH0LXQvdC40LUgVHlwZUVycm9yLlxyXG4gICAgLy8gICAgICAgLy8g0KHQvNC+0YLRgNC40YLQtTogaHR0cDovL2VzNS5naXRodWIuY29tLyN4OS4xMVxyXG4gICAgLy8gICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgLy8gICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoY2FsbGJhY2sgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uJyk7XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gNS4g0JXRgdC70LggdGhpc0FyZyDQv9GA0LjRgdGD0YLRgdGC0LLRg9C10YIsINC/0L7Qu9C+0LbQuNC8IFQg0YDQsNCy0L3Ri9C8IHRoaXNBcmc7INC40L3QsNGH0LUg0L/QvtC70L7QttC40LwgVCDRgNCw0LLQvdGL0LwgdW5kZWZpbmVkLlxyXG4gICAgLy8gICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XHJcbiAgICAvLyAgICAgICAgIFQgPSB0aGlzQXJnO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDYuINCf0L7Qu9C+0LbQuNC8IGsg0YDQsNCy0L3Ri9C8IDBcclxuICAgIC8vICAgICAgIGsgPSAwO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDcuINCf0L7QutCwIGsgPCBsZW4sINCx0YPQtNC10Lwg0L/QvtCy0YLQvtGA0Y/RgtGMXHJcbiAgICAvLyAgICAgICB3aGlsZSAoayA8IGxlbikge1xyXG4gICAgICBcclxuICAgIC8vICAgICAgICAgdmFyIGtWYWx1ZTtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAgIC8vIGEuINCf0L7Qu9C+0LbQuNC8IFBrINGA0LDQstC90YvQvCBUb1N0cmluZyhrKS5cclxuICAgIC8vICAgICAgICAgLy8gICDQrdGC0L4g0L3QtdGP0LLQvdC+0LUg0L/RgNC10L7QsdGA0LDQt9C+0LLQsNC90LjQtSDQtNC70Y8g0LvQtdCy0L7RgdGC0L7RgNC+0L3QvdC10LPQviDQvtC/0LXRgNCw0L3QtNCwINCyINC+0L/QtdGA0LDRgtC+0YDQtSBpblxyXG4gICAgLy8gICAgICAgICAvLyBiLiDQn9C+0LvQvtC20LjQvCBrUHJlc2VudCDRgNCw0LLQvdGL0Lwg0YDQtdC30YPQu9GM0YLQsNGC0YMg0LLRi9C30L7QstCwINCy0L3Rg9GC0YDQtdC90L3QtdCz0L4g0LzQtdGC0L7QtNCwIEhhc1Byb3BlcnR5INC+0LHRitC10LrRgtCwIE8g0YEg0LDRgNCz0YPQvNC10L3RgtC+0LwgUGsuXHJcbiAgICAvLyAgICAgICAgIC8vICAg0K3RgtC+0YIg0YjQsNCzINC80L7QttC10YIg0LHRi9GC0Ywg0L7QsdGK0LXQtNC40L3RkdC9INGBINGI0LDQs9C+0LwgY1xyXG4gICAgLy8gICAgICAgICAvLyBjLiDQldGB0LvQuCBrUHJlc2VudCDRgNCw0LLQtdC9IHRydWUsINGC0L5cclxuICAgIC8vICAgICAgICAgaWYgKGsgaW4gTykge1xyXG4gICAgICBcclxuICAgIC8vICAgICAgICAgICAvLyBpLiDQn9C+0LvQvtC20LjQvCBrVmFsdWUg0YDQsNCy0L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtGDINCy0YvQt9C+0LLQsCDQstC90YPRgtGA0LXQvdC90LXQs9C+INC80LXRgtC+0LTQsCBHZXQg0L7QsdGK0LXQutGC0LAgTyDRgSDQsNGA0LPRg9C80LXQvdGC0L7QvCBQay5cclxuICAgIC8vICAgICAgICAgICBrVmFsdWUgPSBPW2tdO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgICAgICAvLyBpaS4g0JLRi9C30L7QstC10Lwg0LLQvdGD0YLRgNC10L3QvdC40Lkg0LzQtdGC0L7QtCBDYWxsINGE0YPQvdC60YbQuNC4IGNhbGxiYWNrINGBINC+0LHRitC10LrRgtC+0LwgVCDQsiDQutCw0YfQtdGB0YLQstC1INC30L3QsNGH0LXQvdC40Y8gdGhpcyDQuFxyXG4gICAgLy8gICAgICAgICAgIC8vINGB0L/QuNGB0LrQvtC8INCw0YDQs9GD0LzQtdC90YLQvtCyLCDRgdC+0LTQtdGA0LbQsNGJ0LjQvCBrVmFsdWUsIGsg0LggTy5cclxuICAgIC8vICAgICAgICAgICBjYWxsYmFjay5jYWxsKFQsIGtWYWx1ZSwgaywgTyk7XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgLy8gZC4g0KPQstC10LvQuNGH0LjQvCBrINC90LAgMS5cclxuICAgIC8vICAgICAgICAgaysrO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgLy8gICAgICAgLy8gOC4g0JLQtdGA0L3RkdC8IHVuZGVmaW5lZC5cclxuICAgIC8vICAgICB9O1xyXG4gICAgLy8gICB9XHJcbiAgICAgIChmdW5jdGlvbihFTEVNRU5UKSB7XHJcbiAgICAgICAgRUxFTUVOVC5tYXRjaGVzID0gRUxFTUVOVC5tYXRjaGVzIHx8IEVMRU1FTlQubW96TWF0Y2hlc1NlbGVjdG9yIHx8IEVMRU1FTlQubXNNYXRjaGVzU2VsZWN0b3IgfHwgRUxFTUVOVC5vTWF0Y2hlc1NlbGVjdG9yIHx8IEVMRU1FTlQud2Via2l0TWF0Y2hlc1NlbGVjdG9yO1xyXG4gICAgICAgIEVMRU1FTlQuY2xvc2VzdCA9IEVMRU1FTlQuY2xvc2VzdCB8fCBmdW5jdGlvbiBjbG9zZXN0KHNlbGVjdG9yKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcykgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1hdGNoZXMoc2VsZWN0b3IpKSByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudEVsZW1lbnQpIHtyZXR1cm4gbnVsbH1cclxuICAgICAgICAgICAgZWxzZSByZXR1cm4gdGhpcy5wYXJlbnRFbGVtZW50LmNsb3Nlc3Qoc2VsZWN0b3IpXHJcbiAgICAgICAgICB9O1xyXG4gICAgfShFbGVtZW50LnByb3RvdHlwZSkpO1xyXG4gICAgY29uc3Qgd2lkdGggPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fd3JhcHBlclwiKSkud2lkdGg7XHJcbiAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX3dyYXBwZXJcIik7XHJcbiAgICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19pdGVtXCIpO1xyXG4gICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19jb250ZW50XCIpO1xyXG4gICAgY29uc3QgcHJldiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19sZWZ0XCIpO1xyXG4gICAgY29uc3QgbmV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19yaWdodFwiKTtcclxuICAgIGNvbnN0IHNsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyXCIpO1xyXG5cclxubGV0IGNvdW50ID0gMTtcclxuZnVuY3Rpb24gYWRkRG90cygpIHtcclxuICAgIGNvbnN0IGRvdHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgZG90cy5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3RzXCIpO1xyXG5cclxuXHJcbiAgICBlbGVtZW50cy5mb3JFYWNoKChlbCwgaW5kZXgpID0+IHtcclxuICAgICAgICBjb25zdCBkb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXHJcbiAgICAgICAgZG90LmNsYXNzTGlzdC5hZGQoXCJzbGlkZXJfX2RvdFwiKTtcclxuICAgICAgICBkb3Quc2V0QXR0cmlidXRlKFwiZGF0YS1jb3VudFwiLCBpbmRleCArIDEpXHJcbiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgIGRvdC5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpOyAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvdHMuYXBwZW5kQ2hpbGQoZG90KTtcclxuICAgIH0pXHJcblxyXG4gICAgLy8gZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgXHJcbiAgICAvLyB9XHJcblxyXG5cclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyXCIpLmFwcGVuZENoaWxkKGRvdHMpO1xyXG59XHJcbmFkZERvdHMoKTtcclxuXHJcblxyXG5jb250ZW50LnN0eWxlLndpZHRoID0gZWxlbWVudHMubGVuZ3RoICogcGFyc2VJbnQod2lkdGgpICsgXCJweFwiO1xyXG5cclxubmV4dC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZ29OZXh0KTtcclxucHJldi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZ29QcmV2KTtcclxuXHJcbmxldCBpbnRlcnZhbDtcclxuXHJcbmZ1bmN0aW9uIHN0YXJ0SW50ZXJ2YWwoKSB7XHJcbiAgICBpbnRlcnZhbCA9IHNldEludGVydmFsKGdvTmV4dCwgNjAwMCk7XHJcbn1cclxuc3RhcnRJbnRlcnZhbCgpO1xyXG5cclxud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoKSA9PiB7XHJcbiAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcclxufSlcclxuXHJcbndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKCkgPT4ge1xyXG4gICAgc3RhcnRJbnRlcnZhbCgpO1xyXG59KVxyXG5cclxuc2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19kb3RcIikuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiBjaGFuZ2VEb3RzKGUsIG51bGwpKVxyXG59KVxyXG5cclxuZnVuY3Rpb24gY2hhbmdlRG90cyhlLCBjb2xvcikge1xyXG4gICAgaWYgKGUpIHtcclxuICAgICAgICBzbGlkZXIucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXJfX2RvdFwiKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJzbGlkZXJfX2RvdC1hY3RpdmVcIik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1jb3VudFwiKTtcclxuXHJcbiAgICAgICAgY291bnQgPSBpbmRleDtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSAoY291bnQgKiBwYXJzZUludCh3aWR0aCkpIC0gcGFyc2VJbnQod2lkdGgpO1xyXG4gICAgICAgIGNvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7cmVzdWx0fXB4KWA7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgc2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19kb3RcIikuZm9yRWFjaCgoaXRlbSwgaW5kZXgpPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJzbGlkZXJfX2RvdC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCsxID09PSBjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdvTmV4dCgpIHtcclxuICAgIGlmIChjb3VudCA9PT0gZWxlbWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgwKWA7XHJcbiAgICAgICAgY291bnQgPSAxO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IChjb3VudCAtIDEpICogcGFyc2VJbnQod2lkdGgpO1xyXG4gICAgICAgIGNvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7cmVzdWx0fXB4KWA7XHJcbiAgICB9XHJcbiAgICBjaGFuZ2VEb3RzKG51bGwsIFwiY2hhbmdlQ29sb3JcIilcclxufVxyXG5cclxuZnVuY3Rpb24gZ29QcmV2KCkge1xyXG4gICAgaWYgKGNvdW50ID09PSAxKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0oIChlbGVtZW50cy5sZW5ndGggLSAxKSAqIHBhcnNlSW50KHdpZHRoKSkgKyBcInB4XCI7XHJcbiAgICAgICAgY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtyZXN1bHR9KWA7XHJcbiAgICAgICAgY291bnQgPSBlbGVtZW50cy5sZW5ndGg7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvdW50LS07XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gKGNvdW50ICogcGFyc2VJbnQod2lkdGgpKSAtIHBhcnNlSW50KHdpZHRoKTtcclxuICAgICAgICBjb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3Jlc3VsdH1weClgO1xyXG4gICAgfVxyXG4gICAgY2hhbmdlRG90cyhudWxsLCBcImNoYW5nZUNvbG9yXCIpXHJcbn1cclxufVxyXG5cclxuY2F0Y2gge30iXX0=
