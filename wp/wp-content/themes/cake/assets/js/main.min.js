"use strict";window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var c=0;c<this.length;c++)e.call(t,this[c],c,this)});var items=document.querySelectorAll(".cake__item");[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),c=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;c.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(c)}})}),function(){var e=[window.Element,window.CharacterData,window.DocumentType],t=[];e.forEach(function(e){e&&t.push(e.prototype)}),t.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}();try{var btn=document.querySelector(".menu__menu"),block=document.querySelector(".menu__list");btn.addEventListener("click",function(){btn.classList.toggle("menu__menu-active"),btn.classList.contains("menu__menu-active")?block.style.display="block":block.style.display="none"})}catch(e){}try{items.forEach(function(e){e.addEventListener("mouseover",function(e){var t,c=e.target.closest(".cake__item");if(c&&!c.querySelector(".cake__info")){switch(c.dataset.element){case"1":t="cake__goRight";break;case"2":t="cake__goCenter";break;case"3":t="cake__goLeft"}var a=document.createElement("div");a.classList.add("cake__info",t),console.log(a),a.innerHTML='\n                <h3 class="cake__title">'.concat(c.dataset.name,'</h3>\n                <p class="cake__description">').concat(c.dataset.info,'</p>\n                <div class="cake__footer">\n                <span class="cake__gram">').concat(c.dataset.gramm,'г.</span>\n                <span class="cake__price">').concat(c.dataset.price,"Р</span>\n                "),c.append(a)}})}),items.forEach(function(e){e.addEventListener("mouseleave",function(e){document.querySelector(".cake__info").remove()})})}catch(e){}try{var checbox=document.querySelector(".application__label-checkbox"),button=document.querySelector(".application__submit");checbox.addEventListener("click",function(e){var t=checbox.querySelector(".application__checkbox-bad"),c=checbox.querySelector(".application__checkbox-bad-block");t.checked?(t.checked=!1,c.classList.remove("application__checkbox-bad-block-active"),button.classList.add("modal__disabled"),button.classList.remove("modal__submit")):(t.checked=!0,c.classList.add("application__checkbox-bad-block-active"),button.classList.remove("modal__disabled"),button.classList.add("modal__submit"))})}catch(e){}try{var checkbox=document.querySelector(".modal__checkbox"),btnSubmit=document.querySelector(".modal__button"),applicationCheckBox=document.querySelector(".application__checkbox-bad"),applicationSubmit=document.querySelector(".application__submit");try{checkbox.addEventListener("change",function(){checkbox.checked?(btnSubmit.classList.remove("modal__disabled"),btnSubmit.classList.add("modal__submit")):(btnSubmit.classList.add("modal__disabled"),btnSubmit.classList.remove("modal__submit"))})}catch(e){}try{applicationCheckBox.addEventListener("change",function(e){applicationCheckBox.checked?(applicationSubmit.classList.remove("modal__disabled"),applicationSubmit.classList.add("modal__submit")):(applicationSubmit.classList.add("modal__disabled"),applicationSubmit.classList.remove("modal__submit"))})}catch(e){}}catch(e){}try{document.querySelector(".menu-icon").addEventListener("click",function(e){e.target.closest(".menu-icon").classList.toggle("clicked"),document.querySelector(".menu-icon").classList.contains("clicked")?document.querySelector(".header__list-hamburger").classList.add("active-list","header__list-hamburger-animate"):document.querySelector(".header__list-hamburger").classList.remove("active-list")})}catch(e){}try{var iframe=document.createElement("iframe")}catch(e){}try{var btns=document.querySelectorAll(".tort__click"),modal=document.querySelector(".modal"),dialog=document.querySelector(".modal__dialog"),_block=document.querySelector(".modal__block");btns.forEach(function(e){e.addEventListener("click",function(e){document.body.style.overflow="hidden",modal.style.transition="all 1s",modal.style.overflow="auto",modal.classList.add("modal-active");var t=e.target.closest(".tort__item"),c=document.createElement("div");c.classList.add("modal__infoTort"),c.innerHTML='\n                <h2 class="modal__title">Онлайн заказ торта</h2>\n                <div class="modal__info">\n                    <div class="modal__img-block">\n                        <img src="'.concat(t.dataset.img,'" alt="tort" class="modal__img">\n                    </div>\n                    <div class="modal__description">\n                        <h5 class="modal__name">').concat(t.dataset.nameTort,'</h5>\n                        <p class="modal__text">\n                            ').concat(t.dataset.description,'\n                        </p>\n                    </div>\n                </div>\n                <div class="modal__bottom">\n                    <div class="modal__line"></div>\n                    <div class="modal__opis">\n                        <div class="modal__gram">').concat(t.dataset.kg,' кг.</div>\n                        <div class="modal__price">').concat(t.dataset.rub," ₽</div>\n                    </div>\n                </div>\n            "),_block.append(c);var a=document.createElement("input");a.classList.add("input__hidden"),a.value=t.dataset.nameTort,document.querySelector(".hidden__label").append(a)})}),modal.addEventListener("click",function(e){e.target.classList.contains("modal")&&(document.body.style.overflow="",modal.style.transition="none",modal.classList.remove("modal-active"),modal.querySelector(".modal__infoTort").remove(),document.querySelector(".hidden__label").querySelector(".input__hidden").remove())})}catch(e){}try{var conts=document.querySelectorAll(".cont"),inputs=document.querySelector(".application").querySelectorAll(".application-input");conts.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.closest(".cont");t.querySelector("input").focus(),t.querySelector(".placeholder").style.display="none"})}),inputs.forEach(function(e){e.addEventListener("blur",function(e){""==e.target.value.trim()&&(e.target.nextElementSibling.style.display="block")})})}catch(e){}try{var labels=document.querySelectorAll(".application__label");labels.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.closest(".application__label").querySelector(".application__checkbox"),c=e.target.closest(".application__label").querySelector(".application__checkbox-block");t.checked||(document.querySelectorAll(".application__checkbox").forEach(function(e){e.previousElementSibling.classList.remove("application__checkbox-block-active")}),c.classList.add("application__checkbox-block-active"))})})}catch(e){}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var c=0;c<this.length;c++)e.call(t,this[c],c,this)});try{var addDots=function(){var a=document.createElement("div");a.classList.add("slider__dots"),elements.forEach(function(e,t){var c=document.createElement("div");c.classList.add("slider__dot"),c.setAttribute("data-count",t+1),0===t&&c.classList.add("slider__dot-active"),a.appendChild(c)}),document.querySelector(".slider").appendChild(a)},startInterval=function(){interval=setInterval(goNext,6e3)},changeDots=function(e,t){var c,a;e&&(slider.querySelectorAll(".slider__dot").forEach(function(e){e.classList.remove("slider__dot-active")}),e.target.classList.add("slider__dot-active"),c=e.target.getAttribute("data-count"),a=(count=c)*parseInt(width)-parseInt(width),content.style.transform="translateX(-".concat(a,"px)")),t&&slider.querySelectorAll(".slider__dot").forEach(function(e,t){e.classList.remove("slider__dot-active"),t+1===count&&e.classList.add("slider__dot-active")})},goNext=function(){var e;count===elements.length?(content.style.transform="translateX(0)",count=1):(e=(++count-1)*parseInt(width),content.style.transform="translateX(-".concat(e,"px)")),changeDots(null,"changeColor")},goPrev=function(){var e,t;1===count?(e=(elements.length-1)*parseInt(width)+"px",content.style.transform="translateX(-".concat(e,")"),count=elements.length):(t=--count*parseInt(width)-parseInt(width),content.style.transform="translateX(-".concat(t,"px)")),changeDots(null,"changeColor")};!function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,e.closest=e.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null}}(Element.prototype);var interval,width=window.getComputedStyle(document.querySelector(".slider__wrapper")).width,wrapper=document.querySelector(".slider__wrapper"),elements=document.querySelectorAll(".slider__item"),content=document.querySelector(".slider__content"),prev=document.querySelector(".slider__left"),next=document.querySelector(".slider__right"),slider=document.querySelector(".slider"),count=1;addDots(),content.style.width=elements.length*parseInt(width)+"px",next.addEventListener("click",goNext),prev.addEventListener("click",goPrev),startInterval(),wrapper.addEventListener("mouseenter",function(){clearInterval(interval)}),wrapper.addEventListener("mouseleave",function(){startInterval()}),slider.querySelectorAll(".slider__dot").forEach(function(e){e.addEventListener("click",function(e){return changeDots(e,null)})})}catch(e){}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY2FyZGVvbi5qcyIsImNha2UuanMiLCJjaGVja2JveC5qcyIsImZvcm0uanMiLCJoYW1idXJnZXIuanMiLCJpZnJhbWUuanMiLCJtb2RhbC5qcyIsInBsYWNlaG9sZGVyLmpzIiwicmFkaW9idXR0b25zLmpzIiwic2xpZGVyLmpzIl0sIm5hbWVzIjpbIndpbmRvdyIsIk5vZGVMaXN0IiwicHJvdG90eXBlIiwiZm9yRWFjaCIsImNhbGxiYWNrIiwidGhpc0FyZyIsImkiLCJ0aGlzIiwibGVuZ3RoIiwiY2FsbCIsIml0ZW1zIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiRWxlbWVudCIsIkRvY3VtZW50IiwiRG9jdW1lbnRGcmFnbWVudCIsIml0ZW0iLCJoYXNPd25Qcm9wZXJ0eSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwidmFsdWUiLCJhcmdBcnIiLCJBcnJheSIsInNsaWNlIiwiYXJndW1lbnRzIiwiZG9jRnJhZyIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJhcmdJdGVtIiwiaXNOb2RlIiwiTm9kZSIsImFwcGVuZENoaWxkIiwiY3JlYXRlVGV4dE5vZGUiLCJTdHJpbmciLCJhcnIiLCJDaGFyYWN0ZXJEYXRhIiwiRG9jdW1lbnRUeXBlIiwiYXJncyIsInB1c2giLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJidG4iLCJxdWVyeVNlbGVjdG9yIiwiYmxvY2siLCJhZGRFdmVudExpc3RlbmVyIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiY29udGFpbnMiLCJzdHlsZSIsImRpc3BsYXkiLCJfdW51c2VkIiwiZSIsInRyYW5DbGFzcyIsImJvZHkiLCJ0YXJnZXQiLCJjbG9zZXN0IiwiZGF0YXNldCIsImVsZW1lbnQiLCJlbCIsImNyZWF0ZUVsZW1lbnQiLCJhZGQiLCJjb25zb2xlIiwibG9nIiwiaW5uZXJIVE1MIiwiY29uY2F0IiwibmFtZSIsImluZm8iLCJncmFtbSIsInByaWNlIiwiYXBwZW5kIiwicmVtb3ZlIiwiX3VudXNlZDIiLCJjaGVjYm94IiwiYnV0dG9uIiwib2xkQ2hlY2tCb3giLCJuZXdDaGVja0JveCIsImNoZWNrZWQiLCJfdW51c2VkMyIsImNoZWNrYm94IiwiYnRuU3VibWl0IiwiYXBwbGljYXRpb25DaGVja0JveCIsImFwcGxpY2F0aW9uU3VibWl0IiwiX3VudXNlZDQiLCJfdW51c2VkNSIsIl91bnVzZWQ2IiwiX3VudXNlZDciLCJpZnJhbWUiLCJfdW51c2VkOCIsImJ0bnMiLCJtb2RhbCIsImRpYWxvZyIsIm92ZXJmbG93IiwidHJhbnNpdGlvbiIsImltZyIsIm5hbWVUb3J0IiwiZGVzY3JpcHRpb24iLCJrZyIsInJ1YiIsImlucHV0VG9ydCIsIl91bnVzZWQ5IiwiY29udHMiLCJpbnB1dHMiLCJmb2N1cyIsInRyaW0iLCJuZXh0RWxlbWVudFNpYmxpbmciLCJfdW51c2VkMTAiLCJsYWJlbHMiLCJvbGRDaGVja0JveHMiLCJuZXdDaGVja0JveHMiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiX3VudXNlZDExIiwiYWRkRG90cyIsImRvdHMiLCJlbGVtZW50cyIsImluZGV4IiwiZG90Iiwic2V0QXR0cmlidXRlIiwic3RhcnRJbnRlcnZhbCIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJnb05leHQiLCJjaGFuZ2VEb3RzIiwiY29sb3IiLCJyZXN1bHQiLCJzbGlkZXIiLCJnZXRBdHRyaWJ1dGUiLCJjb3VudCIsInBhcnNlSW50Iiwid2lkdGgiLCJjb250ZW50IiwidHJhbnNmb3JtIiwiZ29QcmV2IiwiRUxFTUVOVCIsIm1hdGNoZXMiLCJtb3pNYXRjaGVzU2VsZWN0b3IiLCJtc01hdGNoZXNTZWxlY3RvciIsIm9NYXRjaGVzU2VsZWN0b3IiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJzZWxlY3RvciIsInBhcmVudEVsZW1lbnQiLCJnZXRDb21wdXRlZFN0eWxlIiwid3JhcHBlciIsInByZXYiLCJuZXh0IiwiY2xlYXJJbnRlcnZh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ZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpZiAod2luZG93Lk5vZGVMaXN0ICYmICFOb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCkge1xyXG4gICAgTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcclxuICAgICAgICB0aGlzQXJnID0gdGhpc0FyZyB8fCB3aW5kb3c7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpc1tpXSwgaSwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5jb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2FrZV9faXRlbVwiKTtcclxuKGZ1bmN0aW9uIChhcnIpIHtcclxuICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgIGlmIChpdGVtLmhhc093blByb3BlcnR5KCdhcHBlbmQnKSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaXRlbSwgJ2FwcGVuZCcsIHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kKCkge1xyXG4gICAgICAgICAgdmFyIGFyZ0FyciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksXHJcbiAgICAgICAgICAgIGRvY0ZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgXHJcbiAgICAgICAgICBhcmdBcnIuZm9yRWFjaChmdW5jdGlvbiAoYXJnSXRlbSkge1xyXG4gICAgICAgICAgICB2YXIgaXNOb2RlID0gYXJnSXRlbSBpbnN0YW5jZW9mIE5vZGU7XHJcbiAgICAgICAgICAgIGRvY0ZyYWcuYXBwZW5kQ2hpbGQoaXNOb2RlID8gYXJnSXRlbSA6IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFN0cmluZyhhcmdJdGVtKSkpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgXHJcbiAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKGRvY0ZyYWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KShbRWxlbWVudC5wcm90b3R5cGUsIERvY3VtZW50LnByb3RvdHlwZSwgRG9jdW1lbnRGcmFnbWVudC5wcm90b3R5cGVdKTtcclxuICAoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgYXJyID0gW3dpbmRvdy5FbGVtZW50LCB3aW5kb3cuQ2hhcmFjdGVyRGF0YSwgd2luZG93LkRvY3VtZW50VHlwZV07XHJcbiAgICB2YXIgYXJncyA9IFtdO1xyXG4gIFxyXG4gICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICBhcmdzLnB1c2goaXRlbS5wcm90b3R5cGUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICBcclxuICAgIC8vIGZyb206aHR0cHM6Ly9naXRodWIuY29tL2pzZXJ6L2pzX3BpZWNlL2Jsb2IvbWFzdGVyL0RPTS9DaGlsZE5vZGUvcmVtb3ZlKCkvcmVtb3ZlKCkubWRcclxuICAgIChmdW5jdGlvbiAoYXJyKSB7XHJcbiAgICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgaWYgKGl0ZW0uaGFzT3duUHJvcGVydHkoJ3JlbW92ZScpKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdGVtLCAncmVtb3ZlJywge1xyXG4gICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcclxuICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pKGFyZ3MpO1xyXG4gIH0pKCk7XHJcbnRyeSB7XHJcbiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnVfX21lbnVcIilcclxuICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51X19saXN0XCIpO1xyXG5cclxuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwibWVudV9fbWVudS1hY3RpdmVcIik7XHJcbiAgICAgICAgaWYgKGJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJtZW51X19tZW51LWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICBibG9jay5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJsb2NrLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSBjYXRjaCB7fSIsInRyeSB7XHJcblxyXG5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIGUgPT4ge1xyXG4gICAgICAgIGNvbnN0IGJvZHkgPSBlLnRhcmdldC5jbG9zZXN0KFwiLmNha2VfX2l0ZW1cIik7XHJcbiAgICAgICAgaWYgKGJvZHkpIHtcclxuICAgICAgICAgICAgbGV0IHRyYW5DbGFzcztcclxuICAgICAgICAgICAgaWYgKCFib2R5LnF1ZXJ5U2VsZWN0b3IoXCIuY2FrZV9faW5mb1wiKSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoKGJvZHkuZGF0YXNldC5lbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjFcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuQ2xhc3MgPSBcImNha2VfX2dvUmlnaHRcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiMlwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5DbGFzcyA9IFwiY2FrZV9fZ29DZW50ZXJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCIzXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbkNsYXNzID0gXCJjYWtlX19nb0xlZnRcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChcImNha2VfX2luZm9cIiwgdHJhbkNsYXNzKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVsKTtcclxuICAgICAgICAgICAgICAgIGVsLmlubmVySFRNTCA9IGBcclxuICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cImNha2VfX3RpdGxlXCI+JHtib2R5LmRhdGFzZXQubmFtZX08L2gzPlxyXG4gICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJjYWtlX19kZXNjcmlwdGlvblwiPiR7Ym9keS5kYXRhc2V0LmluZm99PC9wPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNha2VfX2Zvb3RlclwiPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJjYWtlX19ncmFtXCI+JHtib2R5LmRhdGFzZXQuZ3JhbW190LMuPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJjYWtlX19wcmljZVwiPiR7Ym9keS5kYXRhc2V0LnByaWNlfdCgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgYDtcclxuICAgICAgICAgICAgICAgIGJvZHkuYXBwZW5kKGVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTtcclxuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgZSA9PiB7IFxyXG4gICAgICAgIC8vIGNvbnN0IGltZyA9IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWluYyhcImNha2VfX2l0ZW0taW1nXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FrZV9faW5mb1wiKS5yZW1vdmUoKVxyXG5cclxuICAgIH0pXHJcbn0pXHJcbn0gY2F0Y2gge31cclxuXHJcbiIsInRyeSB7XHJcbiAgICBjb25zdCBjaGVjYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fbGFiZWwtY2hlY2tib3hcIik7XHJcbiAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19zdWJtaXRcIik7XHJcblxyXG4gICAgY2hlY2JveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBjb25zdCBvbGRDaGVja0JveCA9IGNoZWNib3gucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkXCIpO1xyXG4gICAgICAgIGNvbnN0IG5ld0NoZWNrQm94ID0gY2hlY2JveC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWQtYmxvY2tcIik7XHJcblxyXG4gICAgICAgIGlmIChvbGRDaGVja0JveC5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgIG9sZENoZWNrQm94LmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgbmV3Q2hlY2tCb3guY2xhc3NMaXN0LnJlbW92ZShcImFwcGxpY2F0aW9uX19jaGVja2JveC1iYWQtYmxvY2stYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZChcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fc3VibWl0XCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG9sZENoZWNrQm94LmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBuZXdDaGVja0JveC5jbGFzc0xpc3QuYWRkKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJhZC1ibG9jay1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX2Rpc2FibGVkXCIpO1xyXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZChcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufSBjYXRjaCB7fSIsInRyeSB7XHJcbiAgICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NoZWNrYm94XCIpO1xyXG4gICAgY29uc3QgYnRuU3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgYXBwbGljYXRpb25DaGVja0JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94LWJhZFwiKTtcclxuICAgIGNvbnN0IGFwcGxpY2F0aW9uU3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fc3VibWl0XCIpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjaGVja2JveC5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIGJ0blN1Ym1pdC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJ0blN1Ym1pdC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX2Rpc2FibGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgYnRuU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fc3VibWl0XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0gY2F0Y2h7fVxyXG4gICAgdHJ5IHtcclxuICAgICAgICBhcHBsaWNhdGlvbkNoZWNrQm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKGFwcGxpY2F0aW9uQ2hlY2tCb3guY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25TdWJtaXQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uU3VibWl0LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fc3VibWl0XCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fc3VibWl0XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0gY2F0Y2gge31cclxufSBjYXRjaCB7fVxyXG5cclxuXHJcbiIsInRyeSB7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnUtaWNvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBlLnRhcmdldC5jbG9zZXN0KFwiLm1lbnUtaWNvblwiKS5jbGFzc0xpc3QudG9nZ2xlKFwiY2xpY2tlZFwiKTtcclxuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51LWljb25cIikuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2xpY2tlZFwiKSkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlcl9fbGlzdC1oYW1idXJnZXJcIikuY2xhc3NMaXN0LmFkZChcImFjdGl2ZS1saXN0XCIsIFwiaGVhZGVyX19saXN0LWhhbWJ1cmdlci1hbmltYXRlXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19saXN0LWhhbWJ1cmdlclwiKS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlLWxpc3RcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufSBjYXRjaCB7fSIsInRyeSB7XHJcbiAgICBsZXQgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcclxuICAgIFxyXG4gICAgLy8gaHR0cHM6Ly95YW5kZXgucnUvbWFwLXdpZGdldC92MS8/dW09Y29uc3RydWN0b3IlM0E5MjYzNmIzNDllYjA2ZjBjYzViOWQ0MzIzZWEwZjFlYjAzMWQ2Mzk5OTI0ZTBlMGMxNzI4ODZiNTdiNWMxYTc5JmFtcDtzb3VyY2U9Y29uc3RydWN0b3JcclxufWNhdGNoIHt9IiwidHJ5IHtcclxuICAgIGNvbnN0IGJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRvcnRfX2NsaWNrXCIpO1xyXG4gICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsXCIpO1xyXG4gICAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGlhbG9nXCIpO1xyXG4gICAgY29uc3QgYmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19ibG9ja1wiKTtcclxuXHJcblxyXG5cclxuICAgIGJ0bnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcclxuICAgICAgICAgICAgbW9kYWwuc3R5bGUudHJhbnNpdGlvbiA9IFwiYWxsIDFzXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLm92ZXJmbG93ID0gXCJhdXRvXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIudG9ydF9faXRlbVwiKTtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19pbmZvVG9ydFwiKTtcclxuICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgICAgICA8aDIgY2xhc3M9XCJtb2RhbF9fdGl0bGVcIj7QntC90LvQsNC50L0g0LfQsNC60LDQtyDRgtC+0YDRgtCwPC9oMj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9faW5mb1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9faW1nLWJsb2NrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHt0YXJnZXQuZGF0YXNldC5pbWd9XCIgYWx0PVwidG9ydFwiIGNsYXNzPVwibW9kYWxfX2ltZ1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9fZGVzY3JpcHRpb25cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGg1IGNsYXNzPVwibW9kYWxfX25hbWVcIj4ke3RhcmdldC5kYXRhc2V0Lm5hbWVUb3J0fTwvaDU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwibW9kYWxfX3RleHRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7dGFyZ2V0LmRhdGFzZXQuZGVzY3JpcHRpb259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19ib3R0b21cIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX2xpbmVcIj48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX29waXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19ncmFtXCI+JHt0YXJnZXQuZGF0YXNldC5rZ30g0LrQsy48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19wcmljZVwiPiR7dGFyZ2V0LmRhdGFzZXQucnVifSDigr08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICBgO1xyXG4gICAgICAgICAgICBibG9jay5hcHBlbmQoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0VG9ydCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgICAgICAgaW5wdXRUb3J0LmNsYXNzTGlzdC5hZGQoXCJpbnB1dF9faGlkZGVuXCIpO1xyXG4gICAgICAgICAgICBpbnB1dFRvcnQudmFsdWUgPSB0YXJnZXQuZGF0YXNldC5uYW1lVG9ydDtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oaWRkZW5fX2xhYmVsXCIpLmFwcGVuZChpbnB1dFRvcnQpO1xyXG5cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLnRyYW5zaXRpb24gPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5mb1RvcnRcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGlkZGVuX19sYWJlbFwiKS5xdWVyeVNlbGVjdG9yKFwiLmlucHV0X19oaWRkZW5cIikucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufSBjYXRjaCB7fSIsInRyeSB7XHJcbiAgICBjb25zdCBjb250cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29udFwiKTtcclxuICAgIGNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25cIikucXVlcnlTZWxlY3RvckFsbChcIi5hcHBsaWNhdGlvbi1pbnB1dFwiKTtcclxuXHJcblxyXG5cclxuICAgIGNvbnRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldC5jbG9zZXN0KFwiLmNvbnRcIik7XHJcbiAgICAgICAgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFwiKS5mb2N1cygpO1xyXG4gICAgICAgIHRhcmdldC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBpbnB1dHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldC52YWx1ZS50cmltKCkgPT0gJycpXHJcbiAgICAgICAgICAgIGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59IGNhdGNoIHt9XHJcblxyXG4iLCJ0cnkge1xyXG4gICAgY29uc3QgbGFiZWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcHBsaWNhdGlvbl9fbGFiZWxcIik7XHJcblxyXG4gICAgbGFiZWxzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG9sZENoZWNrQm94cyA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuYXBwbGljYXRpb25fX2xhYmVsXCIpLnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94XCIpXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0NoZWNrQm94cyA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuYXBwbGljYXRpb25fX2xhYmVsXCIpLnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrXCIpXHJcblxyXG4gICAgICAgICAgICBpZiAoIW9sZENoZWNrQm94cy5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveFwiKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZy5jbGFzc0xpc3QucmVtb3ZlKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIG5ld0NoZWNrQm94cy5jbGFzc0xpc3QuYWRkKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAob2xkQ2hlY2tCb3hzLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgLy8gICAgIG9sZENoZWNrQm94cy5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vICAgICBuZXdDaGVja0JveHMuY2xhc3NMaXN0LnJlbW92ZShcImFwcGxpY2F0aW9uX19jaGVja2JveC1ibG9jay1hY3RpdmVcIilcclxuICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgIG9sZENoZWNrQm94cy5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gICAgIG5ld0NoZWNrQm94cy5jbGFzc0xpc3QuYWRkKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn0gY2F0Y2gge30iLCJpZiAod2luZG93Lk5vZGVMaXN0ICYmICFOb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCkge1xyXG4gICAgTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcclxuICAgICAgICB0aGlzQXJnID0gdGhpc0FyZyB8fCB3aW5kb3c7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpc1tpXSwgaSwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG50cnkge1xyXG4gICAgLy8gaWYgKCFBcnJheS5wcm90b3R5cGUuZm9yRWFjaCkge1xyXG5cclxuICAgIC8vICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIHZhciBULCBrO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIGlmICh0aGlzID09IG51bGwpIHtcclxuICAgIC8vICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignIHRoaXMgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDEuINCf0L7Qu9C+0LbQuNC8IE8g0YDQsNCy0L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtGDINCy0YvQt9C+0LLQsCBUb09iamVjdCBwYXNzaW5nIHRoZSB8dGhpc3wgdmFsdWUgYXMgdGhlIGFyZ3VtZW50LlxyXG4gICAgLy8gICAgICAgdmFyIE8gPSBPYmplY3QodGhpcyk7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gMi4g0J/QvtC70L7QttC40LwgbGVuVmFsdWUg0YDQsNCy0L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtGDINCy0YvQt9C+0LLQsCDQstC90YPRgtGA0LXQvdC90LXQs9C+INC80LXRgtC+0LTQsCBHZXQg0L7QsdGK0LXQutGC0LAgTyDRgSDQsNGA0LPRg9C80LXQvdGC0L7QvCBcImxlbmd0aFwiLlxyXG4gICAgLy8gICAgICAgLy8gMy4g0J/QvtC70L7QttC40LwgbGVuINGA0LDQstC90YvQvCBUb1VpbnQzMihsZW5WYWx1ZSkuXHJcbiAgICAvLyAgICAgICB2YXIgbGVuID0gTy5sZW5ndGggPj4+IDA7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gNC4g0JXRgdC70LggSXNDYWxsYWJsZShjYWxsYmFjaykg0YDQsNCy0LXQvSBmYWxzZSwg0LLRi9C60LjQvdC10Lwg0LjRgdC60LvRjtGH0LXQvdC40LUgVHlwZUVycm9yLlxyXG4gICAgLy8gICAgICAgLy8g0KHQvNC+0YLRgNC40YLQtTogaHR0cDovL2VzNS5naXRodWIuY29tLyN4OS4xMVxyXG4gICAgLy8gICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgLy8gICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoY2FsbGJhY2sgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uJyk7XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gNS4g0JXRgdC70LggdGhpc0FyZyDQv9GA0LjRgdGD0YLRgdGC0LLRg9C10YIsINC/0L7Qu9C+0LbQuNC8IFQg0YDQsNCy0L3Ri9C8IHRoaXNBcmc7INC40L3QsNGH0LUg0L/QvtC70L7QttC40LwgVCDRgNCw0LLQvdGL0LwgdW5kZWZpbmVkLlxyXG4gICAgLy8gICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XHJcbiAgICAvLyAgICAgICAgIFQgPSB0aGlzQXJnO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDYuINCf0L7Qu9C+0LbQuNC8IGsg0YDQsNCy0L3Ri9C8IDBcclxuICAgIC8vICAgICAgIGsgPSAwO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgIC8vIDcuINCf0L7QutCwIGsgPCBsZW4sINCx0YPQtNC10Lwg0L/QvtCy0YLQvtGA0Y/RgtGMXHJcbiAgICAvLyAgICAgICB3aGlsZSAoayA8IGxlbikge1xyXG4gICAgICBcclxuICAgIC8vICAgICAgICAgdmFyIGtWYWx1ZTtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAgIC8vIGEuINCf0L7Qu9C+0LbQuNC8IFBrINGA0LDQstC90YvQvCBUb1N0cmluZyhrKS5cclxuICAgIC8vICAgICAgICAgLy8gICDQrdGC0L4g0L3QtdGP0LLQvdC+0LUg0L/RgNC10L7QsdGA0LDQt9C+0LLQsNC90LjQtSDQtNC70Y8g0LvQtdCy0L7RgdGC0L7RgNC+0L3QvdC10LPQviDQvtC/0LXRgNCw0L3QtNCwINCyINC+0L/QtdGA0LDRgtC+0YDQtSBpblxyXG4gICAgLy8gICAgICAgICAvLyBiLiDQn9C+0LvQvtC20LjQvCBrUHJlc2VudCDRgNCw0LLQvdGL0Lwg0YDQtdC30YPQu9GM0YLQsNGC0YMg0LLRi9C30L7QstCwINCy0L3Rg9GC0YDQtdC90L3QtdCz0L4g0LzQtdGC0L7QtNCwIEhhc1Byb3BlcnR5INC+0LHRitC10LrRgtCwIE8g0YEg0LDRgNCz0YPQvNC10L3RgtC+0LwgUGsuXHJcbiAgICAvLyAgICAgICAgIC8vICAg0K3RgtC+0YIg0YjQsNCzINC80L7QttC10YIg0LHRi9GC0Ywg0L7QsdGK0LXQtNC40L3RkdC9INGBINGI0LDQs9C+0LwgY1xyXG4gICAgLy8gICAgICAgICAvLyBjLiDQldGB0LvQuCBrUHJlc2VudCDRgNCw0LLQtdC9IHRydWUsINGC0L5cclxuICAgIC8vICAgICAgICAgaWYgKGsgaW4gTykge1xyXG4gICAgICBcclxuICAgIC8vICAgICAgICAgICAvLyBpLiDQn9C+0LvQvtC20LjQvCBrVmFsdWUg0YDQsNCy0L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtGDINCy0YvQt9C+0LLQsCDQstC90YPRgtGA0LXQvdC90LXQs9C+INC80LXRgtC+0LTQsCBHZXQg0L7QsdGK0LXQutGC0LAgTyDRgSDQsNGA0LPRg9C80LXQvdGC0L7QvCBQay5cclxuICAgIC8vICAgICAgICAgICBrVmFsdWUgPSBPW2tdO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgICAgICAvLyBpaS4g0JLRi9C30L7QstC10Lwg0LLQvdGD0YLRgNC10L3QvdC40Lkg0LzQtdGC0L7QtCBDYWxsINGE0YPQvdC60YbQuNC4IGNhbGxiYWNrINGBINC+0LHRitC10LrRgtC+0LwgVCDQsiDQutCw0YfQtdGB0YLQstC1INC30L3QsNGH0LXQvdC40Y8gdGhpcyDQuFxyXG4gICAgLy8gICAgICAgICAgIC8vINGB0L/QuNGB0LrQvtC8INCw0YDQs9GD0LzQtdC90YLQvtCyLCDRgdC+0LTQtdGA0LbQsNGJ0LjQvCBrVmFsdWUsIGsg0LggTy5cclxuICAgIC8vICAgICAgICAgICBjYWxsYmFjay5jYWxsKFQsIGtWYWx1ZSwgaywgTyk7XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgLy8gZC4g0KPQstC10LvQuNGH0LjQvCBrINC90LAgMS5cclxuICAgIC8vICAgICAgICAgaysrO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgLy8gICAgICAgLy8gOC4g0JLQtdGA0L3RkdC8IHVuZGVmaW5lZC5cclxuICAgIC8vICAgICB9O1xyXG4gICAgLy8gICB9XHJcbiAgICAgIChmdW5jdGlvbihFTEVNRU5UKSB7XHJcbiAgICAgICAgRUxFTUVOVC5tYXRjaGVzID0gRUxFTUVOVC5tYXRjaGVzIHx8IEVMRU1FTlQubW96TWF0Y2hlc1NlbGVjdG9yIHx8IEVMRU1FTlQubXNNYXRjaGVzU2VsZWN0b3IgfHwgRUxFTUVOVC5vTWF0Y2hlc1NlbGVjdG9yIHx8IEVMRU1FTlQud2Via2l0TWF0Y2hlc1NlbGVjdG9yO1xyXG4gICAgICAgIEVMRU1FTlQuY2xvc2VzdCA9IEVMRU1FTlQuY2xvc2VzdCB8fCBmdW5jdGlvbiBjbG9zZXN0KHNlbGVjdG9yKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcykgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1hdGNoZXMoc2VsZWN0b3IpKSByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudEVsZW1lbnQpIHtyZXR1cm4gbnVsbH1cclxuICAgICAgICAgICAgZWxzZSByZXR1cm4gdGhpcy5wYXJlbnRFbGVtZW50LmNsb3Nlc3Qoc2VsZWN0b3IpXHJcbiAgICAgICAgICB9O1xyXG4gICAgfShFbGVtZW50LnByb3RvdHlwZSkpO1xyXG4gICAgY29uc3Qgd2lkdGggPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fd3JhcHBlclwiKSkud2lkdGg7XHJcbiAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX3dyYXBwZXJcIik7XHJcbiAgICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19pdGVtXCIpO1xyXG4gICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19jb250ZW50XCIpO1xyXG4gICAgY29uc3QgcHJldiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19sZWZ0XCIpO1xyXG4gICAgY29uc3QgbmV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19yaWdodFwiKTtcclxuICAgIGNvbnN0IHNsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyXCIpO1xyXG5cclxubGV0IGNvdW50ID0gMTtcclxuZnVuY3Rpb24gYWRkRG90cygpIHtcclxuICAgIGNvbnN0IGRvdHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgZG90cy5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3RzXCIpO1xyXG5cclxuXHJcbiAgICBlbGVtZW50cy5mb3JFYWNoKChlbCwgaW5kZXgpID0+IHtcclxuICAgICAgICBjb25zdCBkb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXHJcbiAgICAgICAgZG90LmNsYXNzTGlzdC5hZGQoXCJzbGlkZXJfX2RvdFwiKTtcclxuICAgICAgICBkb3Quc2V0QXR0cmlidXRlKFwiZGF0YS1jb3VudFwiLCBpbmRleCArIDEpXHJcbiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgIGRvdC5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpOyAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvdHMuYXBwZW5kQ2hpbGQoZG90KTtcclxuICAgIH0pXHJcblxyXG4gICAgLy8gZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgXHJcbiAgICAvLyB9XHJcblxyXG5cclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyXCIpLmFwcGVuZENoaWxkKGRvdHMpO1xyXG59XHJcbmFkZERvdHMoKTtcclxuXHJcblxyXG5jb250ZW50LnN0eWxlLndpZHRoID0gZWxlbWVudHMubGVuZ3RoICogcGFyc2VJbnQod2lkdGgpICsgXCJweFwiO1xyXG5cclxubmV4dC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZ29OZXh0KTtcclxucHJldi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZ29QcmV2KTtcclxuXHJcbmxldCBpbnRlcnZhbDtcclxuXHJcbmZ1bmN0aW9uIHN0YXJ0SW50ZXJ2YWwoKSB7XHJcbiAgICBpbnRlcnZhbCA9IHNldEludGVydmFsKGdvTmV4dCwgNjAwMCk7XHJcbn1cclxuc3RhcnRJbnRlcnZhbCgpO1xyXG5cclxud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoKSA9PiB7XHJcbiAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcclxufSlcclxuXHJcbndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKCkgPT4ge1xyXG4gICAgc3RhcnRJbnRlcnZhbCgpO1xyXG59KVxyXG5cclxuc2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19kb3RcIikuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiBjaGFuZ2VEb3RzKGUsIG51bGwpKVxyXG59KVxyXG5cclxuZnVuY3Rpb24gY2hhbmdlRG90cyhlLCBjb2xvcikge1xyXG4gICAgaWYgKGUpIHtcclxuICAgICAgICBzbGlkZXIucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXJfX2RvdFwiKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJzbGlkZXJfX2RvdC1hY3RpdmVcIik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1jb3VudFwiKTtcclxuXHJcbiAgICAgICAgY291bnQgPSBpbmRleDtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSAoY291bnQgKiBwYXJzZUludCh3aWR0aCkpIC0gcGFyc2VJbnQod2lkdGgpO1xyXG4gICAgICAgIGNvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7cmVzdWx0fXB4KWA7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgc2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19kb3RcIikuZm9yRWFjaCgoaXRlbSwgaW5kZXgpPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJzbGlkZXJfX2RvdC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCsxID09PSBjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKFwic2xpZGVyX19kb3QtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdvTmV4dCgpIHtcclxuICAgIGlmIChjb3VudCA9PT0gZWxlbWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgwKWA7XHJcbiAgICAgICAgY291bnQgPSAxO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IChjb3VudCAtIDEpICogcGFyc2VJbnQod2lkdGgpO1xyXG4gICAgICAgIGNvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7cmVzdWx0fXB4KWA7XHJcbiAgICB9XHJcbiAgICBjaGFuZ2VEb3RzKG51bGwsIFwiY2hhbmdlQ29sb3JcIilcclxufVxyXG5cclxuZnVuY3Rpb24gZ29QcmV2KCkge1xyXG4gICAgaWYgKGNvdW50ID09PSAxKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0oIChlbGVtZW50cy5sZW5ndGggLSAxKSAqIHBhcnNlSW50KHdpZHRoKSkgKyBcInB4XCI7XHJcbiAgICAgICAgY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtyZXN1bHR9KWA7XHJcbiAgICAgICAgY291bnQgPSBlbGVtZW50cy5sZW5ndGg7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvdW50LS07XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gKGNvdW50ICogcGFyc2VJbnQod2lkdGgpKSAtIHBhcnNlSW50KHdpZHRoKTtcclxuICAgICAgICBjb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3Jlc3VsdH1weClgO1xyXG4gICAgfVxyXG4gICAgY2hhbmdlRG90cyhudWxsLCBcImNoYW5nZUNvbG9yXCIpXHJcbn1cclxufVxyXG5cclxuY2F0Y2gge30iXX0=
