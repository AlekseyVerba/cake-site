"use strict"
document.addEventListener("DOMContentLoaded", () =>{window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var o=0;o<this.length;o++)e.call(t,this[o],o,this)});var items=document.querySelectorAll(".cake__item");[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),o=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;o.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(o)}})}),function(){var e=[window.Element,window.CharacterData,window.DocumentType],t=[];e.forEach(function(e){e&&t.push(e.prototype)}),t.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}();try{var btn=document.querySelector(".menu__menu"),block=document.querySelector(".menu__list");btn.addEventListener("click",function(){btn.classList.toggle("menu__menu-active"),btn.classList.contains("menu__menu-active")?block.style.display="block":block.style.display="none"})}catch(e){}try{var addClass=function(e,o,c){document.querySelectorAll(e).forEach(function(e){var t;e.classList.add(o),c&&((t=document.createElement("div")).classList.add(c),e.append(t))})};addClass(".footer li","footer__item","footer__line"),addClass(".header .header__list li","header__item","header__line"),addClass(".header__list-hamburger li","header__item-hamburger",!1);try{var burgerActive=document.createElement("div");burgerActive.classList.add("burger-line"),document.querySelector(".burger-active").append(burgerActive)}catch(e){}}catch(e){}var category=document.querySelectorAll(".taxonomy.category_menu"),spans=document.querySelectorAll(".current-item");category.forEach(function(e){e.classList.add("infoTorts__home")}),spans.forEach(function(e){e.classList.add("infoTorts__next")});try{items.forEach(function(e){e.addEventListener("mouseover",function(e){var t,o=e.target.closest(".cake__item");if(o&&!o.querySelector(".cake__info")){switch(o.dataset.element){case"1":t="cake__goRight";break;case"2":t="cake__goCenter";break;case"3":t="cake__goLeft"}e=document.createElement("div");e.classList.add("cake__info"),e.classList.add(t),console.log(e),e.innerHTML='\n                <h3 class="cake__title">'.concat(o.dataset.name,'</h3>\n                <p class="cake__description">').concat(o.dataset.info,'</p>\n                <div class="cake__footer">\n                <span class="cake__gram">').concat(o.dataset.gramm,' г.</span>\n                <span class="cake__price">').concat(o.dataset.price," р.</span>\n                "),o.append(e)}})}),items.forEach(function(e){e.addEventListener("mouseleave",function(e){document.querySelector(".cake__info").remove()})})}catch(e){}try{var changeCheckBox=function(e,c,a,t){var n=document.querySelector(e),i=document.querySelector(t);n.addEventListener("click",function(e){var t=n.querySelector(c),o=n.querySelector(a);t.checked?(t.checked=!1,o.classList.remove("application__checkbox-bad-block-active"),i.classList.add("modal__disabled"),i.classList.remove("modal__submit"),i.setAttribute("disabled","true")):(t.checked=!0,o.classList.add("application__checkbox-bad-block-active"),i.classList.remove("modal__disabled"),i.classList.add("modal__submit"),i.removeAttribute("disabled"))})};try{changeCheckBox(".application__label-checkbox",".application__checkbox-bad",".application__checkbox-bad-block",".application__submit")}catch(e){}try{changeCheckBox(".modal__label",".modal__checkbox",".application__checkbox-bad-block",".modal__button")}catch(e){}}catch(e){}$("form").on("submit",function(e){e.preventDefault();var e=$(this).serializeArray(),a=$(this).attr("action"),t=!0;"application_fun"===a&&document.querySelectorAll(".application__checkbox").forEach(function(e){t=!!e.checked}),t?$.post(myajax.url,{form:e,action:a},function(e){for(var t,o,c=0;c<$("form").length;c++)$("form")[c].reset(),document.querySelectorAll(".placeholder").forEach(function(e){e.style.display="block"});"application_fun"===a?((t=document.createElement("div")).classList.add("goodFetch"),t.textContent="Успешно.Ваша заявка отправлена",document.querySelector(".application__form").append(t),setTimeout(function(){t.remove()},4e3)):"page-cont"===a&&(document.querySelector(".modal__content").style.display="none",(o=document.createElement("div")).classList.add("goodFetch"),o.textContent="Успешно.Ваша заявка отправлена",document.querySelector(".modal__dialog").append(o),setTimeout(function(){o.remove(),document.querySelector(".modal__content").style.display="block"},4e3))}):alert("Выберите скидку")});try{var checkbox=document.querySelector(".modal__checkbox"),btnSubmit=document.querySelector(".modal__button"),applicationCheckBox=document.querySelector(".application__checkbox-bad"),applicationSubmit=document.querySelector(".application__submit");try{checkbox.addEventListener("change",function(){checkbox.checked?(btnSubmit.classList.remove("modal__disabled"),btnSubmit.classList.add("modal__submit"),btnSubmit.removeAttribute("disabled")):(btnSubmit.classList.add("modal__disabled"),btnSubmit.setAttribute("disabled","true"),btnSubmit.classList.remove("modal__submit"))})}catch(e){}}catch(e){}try{document.querySelector(".menu-icon").addEventListener("click",function(e){e.target.closest(".menu-icon").classList.toggle("clicked"),document.querySelector(".menu-icon").classList.contains("clicked")?document.querySelector(".header__list-hamburger").classList.add("active-list","header__list-hamburger-animate"):document.querySelector(".header__list-hamburger").classList.remove("active-list")})}catch(e){}try{var iframe=document.createElement("iframe")}catch(e){}try{$(window).scroll(function(){$(document).scrollTop()>$(document).height()-1100&&!$("body").hasClass("loading")&&"undefined"!=typeof true_posts&&(console.log(true_posts),$("body").addClass("loading"),$.post(myajax.url,{action:"news_loadmore",query:true_posts||"",page:current_page||""},function(e){e?(current_page++,$(".menu__loading").before(e),$("body").removeClass("loading")):$(".menu__loading").remove()}))})}catch(e){}try{var btns=document.querySelector(".tort__items"),modal=document.querySelector(".modal"),dialog=document.querySelector(".modal__dialog"),_block=document.querySelector(".modal__block");btns.addEventListener("click",function(e){var t;e.target.closest(".tort__item")&&(document.body.style.overflow="hidden",modal.style.transition="all 1s",modal.style.overflow="auto",modal.classList.add("modal-active"),t=e.target.closest(".tort__item"),(e=document.createElement("div")).classList.add("modal__infoTort"),e.innerHTML='\n                <h2 class="modal__title">Онлайн заказ торта</h2>\n                <div class="modal__info">\n                    <div class="modal__img-block">\n                        <img src="'.concat(t.dataset.img,'" alt="tort" class="modal__img">\n                    </div>\n                    <div class="modal__description">\n                        <h5 class="modal__name">').concat(t.dataset.nameTort,'</h5>\n                        <p class="modal__text">\n                            ').concat(t.dataset.description,'\n                        </p>\n                    </div>\n                </div>\n                <div class="modal__bottom">\n                    <div class="modal__line"></div>\n                    <div class="modal__opis">\n                        <div class="modal__gram">').concat(t.dataset.kg,' кг.</div>\n                        <div class="modal__price">').concat(t.dataset.rub," ₽</div>\n                    </div>\n                </div>\n            "),_block.append(e),(e=document.createElement("input")).classList.add("input__hidden"),e.value=t.dataset.nameTort,e.setAttribute("name","tort"),document.querySelector(".hidden__label").append(e))}),modal.addEventListener("click",function(e){(e.target.classList.contains("modal")||e.target.classList.contains("modal_close"))&&(document.body.style.overflow="",modal.style.transition="none",modal.classList.remove("modal-active"),modal.querySelector(".modal__infoTort").remove(),document.querySelector(".hidden__label").querySelector(".input__hidden").remove())})}catch(e){}try{var conts=document.querySelectorAll(".cont"),inputs=document.querySelector(".application").querySelectorAll(".application-input");conts.forEach(function(e){e.addEventListener("click",function(e){e.target.classList.contains("placeholder")&&e.target.previousElementSibling.focus()})}),inputs.forEach(function(e){e.addEventListener("focus",function(e){e.target.nextElementSibling.style.display="none"}),e.addEventListener("blur",function(e){""==e.target.value.trim()&&(e.target.nextElementSibling.style.display="block")})})}catch(e){}try{var labels=document.querySelectorAll(".application__label");labels.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.closest(".application__label").querySelector(".application__checkbox"),e=e.target.closest(".application__label").querySelector(".application__checkbox-block");t.checked||(console.log("true"),document.querySelectorAll(".application__checkbox-block").forEach(function(e){e.classList.remove("application__checkbox-block-active")}),document.querySelectorAll(".application__checkbox").forEach(function(e){e.checked=!1}),e.classList.add("application__checkbox-block-active"),t.checked=!0)})})}catch(e){}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var o=0;o<this.length;o++)e.call(t,this[o],o,this)});try{!function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,e.closest=e.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null}}(Element.prototype);var swiper=new Swiper(".swiper-container",{slidesPerView:1,spaceBetween:30,loop:!0,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}catch(e){}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY2FyZGVvbi5qcyIsImFkZENsYXNzLmpzIiwiYnJlYWQuanMiLCJjYWtlLmpzIiwiY2hlY2tib3guanMiLCJmZXRjaC5qcyIsImZvcm0uanMiLCJoYW1idXJnZXIuanMiLCJpZnJhbWUuanMiLCJsb2FkbW9yZS5qcyIsIm1vZGFsLmpzIiwicGxhY2Vob2xkZXIuanMiLCJyYWRpb2J1dHRvbnMuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsid2luZG93IiwiTm9kZUxpc3QiLCJwcm90b3R5cGUiLCJmb3JFYWNoIiwiY2FsbGJhY2siLCJ0aGlzQXJnIiwiaSIsInRoaXMiLCJsZW5ndGgiLCJjYWxsIiwiaXRlbXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJFbGVtZW50IiwiRG9jdW1lbnQiLCJEb2N1bWVudEZyYWdtZW50IiwiaXRlbSIsImhhc093blByb3BlcnR5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJ2YWx1ZSIsImFyZ0FyciIsIkFycmF5Iiwic2xpY2UiLCJhcmd1bWVudHMiLCJkb2NGcmFnIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImFyZ0l0ZW0iLCJpc05vZGUiLCJOb2RlIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsIlN0cmluZyIsImFyciIsIkNoYXJhY3RlckRhdGEiLCJEb2N1bWVudFR5cGUiLCJhcmdzIiwicHVzaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImJ0biIsInF1ZXJ5U2VsZWN0b3IiLCJibG9jayIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjb250YWlucyIsInN0eWxlIiwiZGlzcGxheSIsIl91bnVzZWQiLCJhZGRDbGFzcyIsInNlbGVjdG9yIiwiY2xhc3NMaSIsImNsYXNzTGluZSIsImxpbmUiLCJhZGQiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kIiwiYnVyZ2VyQWN0aXZlIiwiX3VudXNlZDIiLCJfdW51c2VkMyIsImNhdGVnb3J5Iiwic3BhbnMiLCJlIiwidHJhbkNsYXNzIiwiYm9keSIsInRhcmdldCIsImNsb3Nlc3QiLCJkYXRhc2V0IiwiZWxlbWVudCIsImVsIiwiY29uc29sZSIsImxvZyIsImlubmVySFRNTCIsImNvbmNhdCIsIm5hbWUiLCJpbmZvIiwiZ3JhbW0iLCJwcmljZSIsInJlbW92ZSIsIl91bnVzZWQ0IiwiY2hhbmdlQ2hlY2tCb3giLCJzZWxlY3RvckxhYmVsIiwic2VsZWN0b3JDaGVja09sZCIsInNlbGVjdG9yQ2hlY2tOZXciLCJidXR0b25TZWxlY3RvciIsImNoZWNib3hCbG9jayIsImJ1dHRvbiIsIm9sZENoZWNrQm94IiwibmV3Q2hlY2tCb3giLCJjaGVja2VkIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiX3VudXNlZDUiLCJfdW51c2VkNiIsIl91bnVzZWQ3IiwiJCIsIm9uIiwicHJldmVudERlZmF1bHQiLCJmb3JtIiwic2VyaWFsaXplQXJyYXkiLCJhY3Rpb24iLCJhdHRyIiwiaGFzUmFkaW8iLCJwb3N0IiwibXlhamF4IiwidXJsIiwiZGF0YSIsInJlc2V0IiwidGV4dENvbnRlbnQiLCJzZXRUaW1lb3V0IiwiYWxlcnQiLCJjaGVja2JveCIsImJ0blN1Ym1pdCIsImFwcGxpY2F0aW9uQ2hlY2tCb3giLCJhcHBsaWNhdGlvblN1Ym1pdCIsIl91bnVzZWQ4IiwiX3VudXNlZDkiLCJfdW51c2VkMTAiLCJpZnJhbWUiLCJfdW51c2VkMTEiLCJzY3JvbGwiLCJzY3JvbGxUb3AiLCJoZWlnaHQiLCJoYXNDbGFzcyIsInRydWVfcG9zdHMiLCJxdWVyeSIsInBhZ2UiLCJjdXJyZW50X3BhZ2UiLCJiZWZvcmUiLCJyZW1vdmVDbGFzcyIsIl91bnVzZWQxMiIsImJ0bnMiLCJtb2RhbCIsImRpYWxvZyIsIm92ZXJmbG93IiwidHJhbnNpdGlvbiIsImltZyIsIm5hbWVUb3J0IiwiZGVzY3JpcHRpb24iLCJrZyIsInJ1YiIsImlucHV0VG9ydCIsIl91bnVzZWQxMyIsImNvbnRzIiwiaW5wdXRzIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImZvY3VzIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidHJpbSIsIl91bnVzZWQxNCIsImxhYmVscyIsIm9sZENoZWNrQm94cyIsIm5ld0NoZWNrQm94cyIsIl91bnVzZWQxNSIsIkVMRU1FTlQiLCJtYXRjaGVzIiwibW96TWF0Y2hlc1NlbGVjdG9yIiwibXNNYXRjaGVzU2VsZWN0b3IiLCJvTWF0Y2hlc1NlbGVjdG9yIiwid2Via2l0TWF0Y2hlc1NlbGVjdG9yIiwicGFyZW50RWxlbWVudCIsInN3aXBlciIsIlN3aXBlciIsInNsaWRlc1BlclZpZXciLCJzcGFjZUJldHdlZW4iLCJsb29wIiwicGFnaW5hdGlvbiIsImNsaWNrYWJsZSIsIm5hdmlnYXRpb24iLCJuZXh0RWwiLCJwcmV2RWwiLCJfdW51c2VkMTYiXSwibWFwcGluZ3MiOiJhQUFBQSxPQUFBQyxXQUFBQSxTQUFBQyxVQUFBQyxVQUNBRixTQUFBQyxVQUFBQyxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FBLEVBQUFBLEdBQUFMLE9BQ0EsSUFBQSxJQUFBTSxFQUFBLEVBQUFBLEVBQUFDLEtBQUFDLE9BQUFGLElBQ0FGLEVBQUFLLEtBQUFKLEVBQUFFLEtBQUFELEdBQUFBLEVBQUFDLFFBSUEsSUFBQUcsTUFBQUMsU0FBQUMsaUJBQUEsZUF1QkEsQ0FBQUMsUUFBQVgsVUFBQVksU0FBQVosVUFBQWEsaUJBQUFiLFdBckJBQyxRQUFBLFNBQUFhLEdBQ0FBLEVBQUFDLGVBQUEsV0FHQUMsT0FBQUMsZUFBQUgsRUFBQSxTQUFBLENBQ0FJLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxVQUFBLEVBQ0FDLE1BQUEsV0FDQSxJQUFBQyxFQUFBQyxNQUFBdkIsVUFBQXdCLE1BQUFqQixLQUFBa0IsV0FDQUMsRUFBQWpCLFNBQUFrQix5QkFFQUwsRUFBQXJCLFFBQUEsU0FBQTJCLEdBQ0EsSUFBQUMsRUFBQUQsYUFBQUUsS0FDQUosRUFBQUssWUFBQUYsRUFB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LFFBQUEsdUJBQUExQixjQUFBLGdDQUVBK0csRUFBQTlELFVBQ0FuQixRQUFBQyxJQUFBLFFBQ0FoRSxTQUFBQyxpQkFBQSxnQ0FBQVQsUUFBQSxTQUFBcUUsR0FDQUEsRUFBQXpCLFVBQUFtQyxPQUFBLHdDQUVBdkUsU0FBQUMsaUJBQUEsMEJBQUFULFFBQUEsU0FBQXNFLEdBQ0FBLEVBQUFvQixTQUFBLElBRUErRCxFQUFBN0csVUFBQVcsSUFBQSxzQ0FDQWlHLEVBQUE5RCxTQUFBLE9BYUEsTUFBQWdFLElDL0JBN0osT0FBQUMsV0FBQUEsU0FBQUMsVUFBQUMsVUFDQUYsU0FBQUMsVUFBQUMsUUFBQSxTQUFBQyxFQUFBQyxHQUNBQSxFQUFBQSxHQUFBTCxPQUNBLElBQUEsSUFBQU0sRUFBQSxFQUFBQSxFQUFBQyxLQUFBQyxPQUFBRixJQUNBRixFQUFBSyxLQUFBSixFQUFBRSxLQUFBRCxHQUFBQSxFQUFBQyxRQUlBLEtBeURBLFNBQUF1SixHQUNBQSxFQUFBQyxRQUFBRCxFQUFBQyxTQUFBRCxFQUFBRSxvQkFBQUYsRUFBQUcsbUJBQUFILEVBQUFJLGtCQUFBSixFQUFBSyxzQkFDQUwsRUFBQXhGLFFBQUF3RixFQUFBeEYsU0FBQSxTQUFBaEIsR0FDQSxPQUFBL0MsS0FDQUEsS0FBQXdKLFFBQUF6RyxHQUFBL0MsS0FDQUEsS0FBQTZKLGNBQ0E3SixLQUFBNkosY0FBQTlGLFFBQUFoQixHQURBLEtBRkEsTUFIQSxDQVFBekMsUUFBQVgsV0FpQ0EsSUFBQW1LLE9BQUEsSUFBQUMsT0FBQSxvQkFBQSxDQUNBQyxjQUFBLEVBQ0FDLGFBQUEsR0FDQUMsTUFBQSxFQUNBQyxXQUFBLENBQ0FqRyxHQUFBLHFCQUNBa0csV0FBQSxHQUVBQyxXQUFBLENBQ0FDLE9BQUEsc0JBQ0FDLE9BQUEseUJBNEpBLE1BQUFDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpZiAod2luZG93Lk5vZGVMaXN0ICYmICFOb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCkge1xyXG4gICAgTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcclxuICAgICAgICB0aGlzQXJnID0gdGhpc0FyZyB8fCB3aW5kb3c7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpc1tpXSwgaSwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5jb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2FrZV9faXRlbVwiKTtcclxuKGZ1bmN0aW9uIChhcnIpIHtcclxuICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgIGlmIChpdGVtLmhhc093blByb3BlcnR5KCdhcHBlbmQnKSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaXRlbSwgJ2FwcGVuZCcsIHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kKCkge1xyXG4gICAgICAgICAgdmFyIGFyZ0FyciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksXHJcbiAgICAgICAgICAgIGRvY0ZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgXHJcbiAgICAgICAgICBhcmdBcnIuZm9yRWFjaChmdW5jdGlvbiAoYXJnSXRlbSkge1xyXG4gICAgICAgICAgICB2YXIgaXNOb2RlID0gYXJnSXRlbSBpbnN0YW5jZW9mIE5vZGU7XHJcbiAgICAgICAgICAgIGRvY0ZyYWcuYXBwZW5kQ2hpbGQoaXNOb2RlID8gYXJnSXRlbSA6IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFN0cmluZyhhcmdJdGVtKSkpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgXHJcbiAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKGRvY0ZyYWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KShbRWxlbWVudC5wcm90b3R5cGUsIERvY3VtZW50LnByb3RvdHlwZSwgRG9jdW1lbnRGcmFnbWVudC5wcm90b3R5cGVdKTtcclxuICAoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgYXJyID0gW3dpbmRvdy5FbGVtZW50LCB3aW5kb3cuQ2hhcmFjdGVyRGF0YSwgd2luZG93LkRvY3VtZW50VHlwZV07XHJcbiAgICB2YXIgYXJncyA9IFtdO1xyXG4gIFxyXG4gICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICBhcmdzLnB1c2goaXRlbS5wcm90b3R5cGUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICBcclxuICAgIC8vIGZyb206aHR0cHM6Ly9naXRodWIuY29tL2pzZXJ6L2pzX3BpZWNlL2Jsb2IvbWFzdGVyL0RPTS9DaGlsZE5vZGUvcmVtb3ZlKCkvcmVtb3ZlKCkubWRcclxuICAgIChmdW5jdGlvbiAoYXJyKSB7XHJcbiAgICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgaWYgKGl0ZW0uaGFzT3duUHJvcGVydHkoJ3JlbW92ZScpKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdGVtLCAncmVtb3ZlJywge1xyXG4gICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcclxuICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pKGFyZ3MpO1xyXG4gIH0pKCk7XHJcbnRyeSB7XHJcbiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnVfX21lbnVcIilcclxuICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51X19saXN0XCIpO1xyXG5cclxuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwibWVudV9fbWVudS1hY3RpdmVcIik7XHJcbiAgICAgICAgaWYgKGJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJtZW51X19tZW51LWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICBibG9jay5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJsb2NrLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSBjYXRjaCB7fSIsIlxyXG5cclxudHJ5IHtcclxuICAgIGZ1bmN0aW9uIGFkZENsYXNzKHNlbGVjdG9yLCBjbGFzc0xpLCBjbGFzc0xpbmUpIHtcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoY2xhc3NMaSk7XHJcbiAgICAgICAgICAgIGlmIChjbGFzc0xpbmUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAgICAgbGluZS5jbGFzc0xpc3QuYWRkKGNsYXNzTGluZSk7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmFwcGVuZChsaW5lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFkZENsYXNzKFwiLmZvb3RlciBsaVwiLCBcImZvb3Rlcl9faXRlbVwiLCBcImZvb3Rlcl9fbGluZVwiKTtcclxuICAgIGFkZENsYXNzKFwiLmhlYWRlciAuaGVhZGVyX19saXN0IGxpXCIsIFwiaGVhZGVyX19pdGVtXCIsIFwiaGVhZGVyX19saW5lXCIpO1xyXG4gICAgYWRkQ2xhc3MoXCIuaGVhZGVyX19saXN0LWhhbWJ1cmdlciBsaVwiLCBcImhlYWRlcl9faXRlbS1oYW1idXJnZXJcIiwgZmFsc2UpO1xyXG4gICAgXHJcbiAgIHRyeSB7XHJcbiAgICBjb25zdCBidXJnZXJBY3RpdmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgYnVyZ2VyQWN0aXZlLmNsYXNzTGlzdC5hZGQoXCJidXJnZXItbGluZVwiKTtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnVyZ2VyLWFjdGl2ZVwiKS5hcHBlbmQoYnVyZ2VyQWN0aXZlKTtcclxuICAgfSBjYXRjaHt9XHJcbn0gY2F0Y2gge30iLCIvLyBjb25zdCBidG5zSG9tZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaG9tZVwiKTtcclxuY29uc3QgY2F0ZWdvcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRheG9ub215LmNhdGVnb3J5X21lbnVcIilcclxuY29uc3Qgc3BhbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmN1cnJlbnQtaXRlbVwiKTtcclxuXHJcbmNhdGVnb3J5LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJpbmZvVG9ydHNfX2hvbWVcIik7XHJcbn0pO1xyXG5cclxuXHJcblxyXG5zcGFucy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKFwiaW5mb1RvcnRzX19uZXh0XCIpO1xyXG59KTtcclxuXHJcblxyXG4vLyBpbmZvVG9ydHNfX2hvbWUiLCJ0cnkge1xyXG5cclxuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCBlID0+IHtcclxuICAgICAgICBjb25zdCBib2R5ID0gZS50YXJnZXQuY2xvc2VzdChcIi5jYWtlX19pdGVtXCIpO1xyXG4gICAgICAgIGlmIChib2R5KSB7XHJcbiAgICAgICAgICAgIGxldCB0cmFuQ2xhc3M7XHJcbiAgICAgICAgICAgIGlmICghYm9keS5xdWVyeVNlbGVjdG9yKFwiLmNha2VfX2luZm9cIikpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaChib2R5LmRhdGFzZXQuZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCIxXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbkNsYXNzID0gXCJjYWtlX19nb1JpZ2h0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjJcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuQ2xhc3MgPSBcImNha2VfX2dvQ2VudGVyXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiM1wiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5DbGFzcyA9IFwiY2FrZV9fZ29MZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJjYWtlX19pbmZvXCIpO1xyXG4gICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCh0cmFuQ2xhc3MpXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlbCk7XHJcbiAgICAgICAgICAgICAgICBlbC5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XCJjYWtlX190aXRsZVwiPiR7Ym9keS5kYXRhc2V0Lm5hbWV9PC9oMz5cclxuICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwiY2FrZV9fZGVzY3JpcHRpb25cIj4ke2JvZHkuZGF0YXNldC5pbmZvfTwvcD5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjYWtlX19mb290ZXJcIj5cclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2FrZV9fZ3JhbVwiPiR7Ym9keS5kYXRhc2V0LmdyYW1tfSDQsy48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNha2VfX3ByaWNlXCI+JHtib2R5LmRhdGFzZXQucHJpY2V9INGALjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIGA7XHJcbiAgICAgICAgICAgICAgICBib2R5LmFwcGVuZChlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSk7XHJcbml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGUgPT4geyBcclxuICAgICAgICAvLyBjb25zdCBpbWcgPSBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbmMoXCJjYWtlX19pdGVtLWltZ1wiKTtcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNha2VfX2luZm9cIikucmVtb3ZlKClcclxuXHJcbiAgICB9KVxyXG59KVxyXG59IGNhdGNoIHt9XHJcblxyXG4iLCJ0cnkge1xyXG4gICAgLy8gY29uc3QgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fbGFiZWwtY2hlY2tib3hcIik7XHJcbiAgICAvLyBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19zdWJtaXRcIik7XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIGNoYW5nZUNoZWNrQm94KHNlbGVjdG9yTGFiZWwsIHNlbGVjdG9yQ2hlY2tPbGQsIHNlbGVjdG9yQ2hlY2tOZXcsIGJ1dHRvblNlbGVjdG9yKSB7XHJcbiAgICAgICAgY29uc3QgY2hlY2JveEJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvckxhYmVsKTtcclxuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBidXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgY2hlY2JveEJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcclxuICAgICAgICBjb25zdCBvbGRDaGVja0JveCA9IGNoZWNib3hCbG9jay5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yQ2hlY2tPbGQpO1xyXG4gICAgICAgIGNvbnN0IG5ld0NoZWNrQm94ID0gY2hlY2JveEJsb2NrLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JDaGVja05ldyk7XHJcblxyXG5cclxuICAgICAgICBpZiAob2xkQ2hlY2tCb3guY2hlY2tlZCkge1xyXG4gICAgICAgICAgICBvbGRDaGVja0JveC5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG5ld0NoZWNrQm94LmNsYXNzTGlzdC5yZW1vdmUoXCJhcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkLWJsb2NrLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG9sZENoZWNrQm94LmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBuZXdDaGVja0JveC5jbGFzc0xpc3QuYWRkKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJhZC1ibG9jay1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX2Rpc2FibGVkXCIpO1xyXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZChcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNoYW5nZUNoZWNrQm94KFwiLmFwcGxpY2F0aW9uX19sYWJlbC1jaGVja2JveFwiLCBcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkXCIsIFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWQtYmxvY2tcIiwgXCIuYXBwbGljYXRpb25fX3N1Ym1pdFwiKVxyXG4gICAgfSBjYXRjaCB7fVxyXG4gICAgdHJ5IHtcclxuICAgICAgICBjaGFuZ2VDaGVja0JveChcIi5tb2RhbF9fbGFiZWxcIiwgXCIubW9kYWxfX2NoZWNrYm94XCIsIFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWQtYmxvY2tcIiwgXCIubW9kYWxfX2J1dHRvblwiKVxyXG4gICAgfSBjYXRjaCB7fVxyXG5cclxuXHJcblxyXG4gICAgLy8gY2hlY2JveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIC8vICAgICAvLyBjb25zdCBvbGRDaGVja0JveCA9IGNoZWNib3gucXVlcnlTZWxlY3RvcihcIi5hcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkXCIpO1xyXG4gICAgLy8gICAgIC8vIGNvbnN0IG5ld0NoZWNrQm94ID0gY2hlY2JveC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWQtYmxvY2tcIik7XHJcblxyXG4gICAgLy8gICAgIGlmIChvbGRDaGVja0JveC5jaGVja2VkKSB7XHJcbiAgICAvLyAgICAgICAgIG9sZENoZWNrQm94LmNoZWNrZWQgPSBmYWxzZTtcclxuICAgIC8vICAgICAgICAgbmV3Q2hlY2tCb3guY2xhc3NMaXN0LnJlbW92ZShcImFwcGxpY2F0aW9uX19jaGVja2JveC1iYWQtYmxvY2stYWN0aXZlXCIpO1xyXG4gICAgLy8gICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZChcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgIC8vICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fc3VibWl0XCIpO1xyXG4gICAgLy8gICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXHJcbiAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgIC8vICAgICAgICAgb2xkQ2hlY2tCb3guY2hlY2tlZCA9IHRydWU7XHJcbiAgICAvLyAgICAgICAgIG5ld0NoZWNrQm94LmNsYXNzTGlzdC5hZGQoXCJhcHBsaWNhdGlvbl9fY2hlY2tib3gtYmFkLWJsb2NrLWFjdGl2ZVwiKTtcclxuICAgIC8vICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAvLyAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX3N1Ym1pdFwiKTtcclxuICAgIC8vICAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpXHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfSlcclxuXHJcblxyXG5cclxuXHJcbiAgICAvLyB0cnkge1xyXG4gICAgICAgIFxyXG4gICAgLy8gfVxyXG59IGNhdGNoIHt9IiwiJCgnZm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB2YXIgZm9ybSA9ICQodGhpcykuc2VyaWFsaXplQXJyYXkoKTtcclxuICAgIHZhciBhY3Rpb24gPSAkKHRoaXMpLmF0dHIoJ2FjdGlvbicpO1xyXG4gICAgbGV0IGhhc1JhZGlvID0gdHJ1ZTtcclxuICAgIGlmIChhY3Rpb24gPT09IFwiYXBwbGljYXRpb25fZnVuXCIpIHtcclxuICAgICAgbGV0IHJhZGlvQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94XCIpO1xyXG4gICAgICByYWRpb0J1dHRvbnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpZiAoaXRlbS5jaGVja2VkKSB7XHJcbiAgICAgICAgICBoYXNSYWRpbyA9IHRydWVcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaGFzUmFkaW8gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBpZiAoaGFzUmFkaW8pIHtcclxuICAgICAgJC5wb3N0IChcclxuICAgICAgICBteWFqYXgudXJsLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGZvcm06IGZvcm0sXHJcbiAgICAgICAgICBhY3Rpb246IGFjdGlvblxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkKCdmb3JtJykubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgJCgnZm9ybScpW2ldLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucGxhY2Vob2xkZXJcIikuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICBpdGVtLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgICBpZiAoYWN0aW9uID09PSBcImFwcGxpY2F0aW9uX2Z1blwiKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJnb29kRmV0Y2hcIik7XHJcbiAgICAgICAgICAgICAgZWwudGV4dENvbnRlbnQgPSBcItCj0YHQv9C10YjQvdC+LtCS0LDRiNCwINC30LDRj9Cy0LrQsCDQvtGC0L/RgNCw0LLQu9C10L3QsFwiO1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2Zvcm1cIikuYXBwZW5kKGVsKTtcclxuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGVsLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgIH0sIDQwMDApXHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gXCJwYWdlLWNvbnRcIikge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250ZW50XCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKFwiZ29vZEZldGNoXCIpO1xyXG4gICAgICAgICAgICBlbC50ZXh0Q29udGVudCA9IFwi0KPRgdC/0LXRiNC90L4u0JLQsNGI0LAg0LfQsNGP0LLQutCwINC+0YLQv9GA0LDQstC70LXQvdCwXCJcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGlhbG9nXCIpLmFwcGVuZChlbCk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGVsLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NvbnRlbnRcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICAgICAgfSwgNDAwMClcclxuICAgICAgICAgIH1cclxuICBcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGFsZXJ0KFwi0JLRi9Cx0LXRgNC40YLQtSDRgdC60LjQtNC60YNcIilcclxuICAgIH1cclxuICB9KTsiLCJ0cnkge1xyXG4gICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jaGVja2JveFwiKTtcclxuICAgIGNvbnN0IGJ0blN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIGNvbnN0IGFwcGxpY2F0aW9uQ2hlY2tCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uX19jaGVja2JveC1iYWRcIik7XHJcbiAgICBjb25zdCBhcHBsaWNhdGlvblN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX3N1Ym1pdFwiKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY2hlY2tib3guY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgYnRuU3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19kaXNhYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIGJ0blN1Ym1pdC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcInRydWVcIik7XHJcbiAgICAgICAgICAgICAgICBidG5TdWJtaXQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSBjYXRjaHt9XHJcbiAgICAvLyB0cnkge1xyXG4gICAgLy8gICAgIGFwcGxpY2F0aW9uQ2hlY2tCb3guYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZSkgPT4ge1xyXG4gICAgLy8gICAgICAgICBpZiAoYXBwbGljYXRpb25DaGVja0JveC5jaGVja2VkKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBhcHBsaWNhdGlvblN1Ym1pdC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX2Rpc2FibGVkXCIpO1xyXG4gICAgLy8gICAgICAgICAgICAgYnRuU3VibWl0LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgLy8gICAgICAgICAgICAgYXBwbGljYXRpb25TdWJtaXQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAvLyAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgICAgICAgICBhcHBsaWNhdGlvblN1Ym1pdC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX2Rpc2FibGVkXCIpO1xyXG4gICAgLy8gICAgICAgICAgICAgYXBwbGljYXRpb25TdWJtaXQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19zdWJtaXRcIik7XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gfSBjYXRjaCB7fVxyXG59IGNhdGNoIHt9XHJcblxyXG5cclxuIiwidHJ5IHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudS1pY29uXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCIubWVudS1pY29uXCIpLmNsYXNzTGlzdC50b2dnbGUoXCJjbGlja2VkXCIpO1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnUtaWNvblwiKS5jbGFzc0xpc3QuY29udGFpbnMoXCJjbGlja2VkXCIpKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19saXN0LWhhbWJ1cmdlclwiKS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlLWxpc3RcIiwgXCJoZWFkZXJfX2xpc3QtaGFtYnVyZ2VyLWFuaW1hdGVcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2xpc3QtaGFtYnVyZ2VyXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmUtbGlzdFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59IGNhdGNoIHt9IiwidHJ5IHtcclxuICAgIGxldCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xyXG4gICAgXHJcbiAgICAvLyBodHRwczovL3lhbmRleC5ydS9tYXAtd2lkZ2V0L3YxLz91bT1jb25zdHJ1Y3RvciUzQTkyNjM2YjM0OWViMDZmMGNjNWI5ZDQzMjNlYTBmMWViMDMxZDYzOTk5MjRlMGUwYzE3Mjg4NmI1N2I1YzFhNzkmYW1wO3NvdXJjZT1jb25zdHJ1Y3RvclxyXG59Y2F0Y2gge30iLCJ0cnkge1xyXG4gICAgXHJcblxyXG4vLyBqUXVlcnkoZnVuY3Rpb24oJCl7XHJcbiAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBib3R0b21PZmZzZXQgPSAxMTAwO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwidG9wIDogXCIgKyAkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSlcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcImhlaWdodCA6IFwiICsgJChkb2N1bWVudCkuaGVpZ2h0KCkpXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJtaW51czogXCIgKyAkKGRvY3VtZW50KS5oZWlnaHQoKSAtIGJvdHRvbU9mZnNldClcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhib3R0b21PZmZzZXQpXHJcbiAgICAgICAgaWYoICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpID4gKCQoZG9jdW1lbnQpLmhlaWdodCgpIC0gYm90dG9tT2Zmc2V0KSAmJiAhJCgnYm9keScpLmhhc0NsYXNzKCdsb2FkaW5nJykpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0cnVlX3Bvc3RzICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0cnVlX3Bvc3RzKVxyXG4gICAgICAgICAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdsb2FkaW5nJylcclxuICAgICAgICAgICAgICAgICQucG9zdCAoXHJcbiAgICAgICAgICAgICAgICAgICAgbXlhamF4LnVybCxcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ25ld3NfbG9hZG1vcmUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeTogdHJ1ZV9wb3N0cyB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlIDogY3VycmVudF9wYWdlIHx8IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oIHhocil7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIFx0JCgnYm9keScpLmFkZENsYXNzKCdsb2FkaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBkYXRhICkgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICQoJy5tZW51X19mb29kcycpLmFwcGVuZChkYXRhKTsgLy8g0LLRgdGC0LDQstC70Y/QtdC8INC90L7QstGL0LUg0L/QvtGB0YLRi1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9wYWdlKys7IC8vINGD0LLQtdC70LjRh9C40LLQsNC10Lwg0L3QvtC80LXRgCDRgdGC0YDQsNC90LjRhtGLINC90LAg0LXQtNC40L3QuNGG0YNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5tZW51X19sb2FkaW5nJykuYmVmb3JlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XHJcbiAgICAvLyBcdFx0XHRcdFx0XHRjdXJyZW50X3BhZ2UrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICQoJyNuZXdzX2xvYWRtb3JlJykucmVtb3ZlKCk7IC8vINC10YHQu9C4INC80Ysg0LTQvtGI0LvQuCDQtNC+INC/0L7RgdC70LXQtNC90LXQuSDRgdGC0YDQsNC90LjRhtGLINC/0L7RgdGC0L7Qsiwg0YHQutGA0L7QtdC8INC60L3QvtC/0LrRg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLm1lbnVfX2xvYWRpbmcnKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4vLyB9KTtcclxuXHJcblxyXG5cclxufSBjYXRjaCB7fVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vLyBqUXVlcnkoZnVuY3Rpb24oJCl7XHJcbi8vIFx0JCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbigpe1xyXG4vLyBcdFx0dmFyIGJvdHRvbU9mZnNldCA9IDQwMDsgLy8g0L7RgtGB0YLRg9C/INC+0YIg0L3QuNC20L3QtdC5INCz0YDQsNC90LjRhtGLINGB0LDQudGC0LAsINC00L4g0LrQvtGC0L7RgNC+0LPQviDQtNC+0LvQttC10L0g0LTQvtGB0LrRgNC+0LvQu9C40YLRjCDQv9C+0LvRjNC30L7QstCw0YLQtdC70YwsINGH0YLQvtCx0Ysg0L/QvtC00LPRgNGD0LfQuNC70LjRgdGMINC90L7QstGL0LUg0L/QvtGB0YLRi1xyXG4vLyBcdFx0dmFyIGRhdGEgPSB7XHJcbi8vIFx0XHRcdCdhY3Rpb24nOiAnbG9hZG1vcmUnLFxyXG4vLyBcdFx0XHQncXVlcnknOiB0cnVlX3Bvc3RzLFxyXG4vLyBcdFx0XHQncGFnZScgOiBjdXJyZW50X3BhZ2VcclxuLy8gXHRcdH07XHJcbi8vICAgICAgICAgLy8gY29uc29sZS5sb2coJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkpXHJcbi8vICAgICAgICAgLy8gY29uc29sZS5sb2coJChkb2N1bWVudCkuaGVpZ2h0KCkpXHJcbi8vIFx0XHRpZiggJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkgPiAoJChkb2N1bWVudCkuaGVpZ2h0KCkgLSBib3R0b21PZmZzZXQpICYmICEkKCdib2R5JykuaGFzQ2xhc3MoJ2xvYWRpbmcnKSl7XHJcbi8vIFx0XHRcdCQuYWpheCh7XHJcbi8vIFx0XHRcdFx0dXJsOmFqYXh1cmwsXHJcbi8vIFx0XHRcdFx0ZGF0YTpkYXRhLFxyXG4vLyBcdFx0XHRcdHR5cGU6J1BPU1QnLFxyXG4vLyBcdFx0XHRcdGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKCB4aHIpe1xyXG4vLyBcdFx0XHRcdFx0JCgnYm9keScpLmFkZENsYXNzKCdsb2FkaW5nJyk7XHJcbi8vIFx0XHRcdFx0fSxcclxuLy8gXHRcdFx0XHRzdWNjZXNzOmZ1bmN0aW9uKGRhdGEpe1xyXG4vLyBcdFx0XHRcdFx0aWYoIGRhdGEgKSB7IFxyXG4vLyBcdFx0XHRcdFx0XHQkKCcjdHJ1ZV9sb2FkbW9yZScpLmJlZm9yZShkYXRhKTtcclxuLy8gXHRcdFx0XHRcdFx0JCgnYm9keScpLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XHJcbi8vIFx0XHRcdFx0XHRcdGN1cnJlbnRfcGFnZSsrO1xyXG4vLyBcdFx0XHRcdFx0fVxyXG4vLyBcdFx0XHRcdH1cclxuLy8gXHRcdFx0fSk7XHJcbi8vIFx0XHR9XHJcbi8vIFx0fSk7XHJcbi8vIH0pOyIsInRyeSB7XHJcbiAgICBjb25zdCBidG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b3J0X19pdGVtc1wiKTtcclxuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbFwiKTtcclxuICAgIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2RpYWxvZ1wiKTtcclxuICAgIGNvbnN0IGJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYmxvY2tcIik7XHJcblxyXG5cclxuXHJcbiAgICAvLyBidG5zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgYnRucy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICAgICBpZiAoIGUudGFyZ2V0LmNsb3Nlc3QoXCIudG9ydF9faXRlbVwiKSkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcclxuICAgICAgICAgICAgbW9kYWwuc3R5bGUudHJhbnNpdGlvbiA9IFwiYWxsIDFzXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLm92ZXJmbG93ID0gXCJhdXRvXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIudG9ydF9faXRlbVwiKTtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19pbmZvVG9ydFwiKTtcclxuICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgICAgICA8aDIgY2xhc3M9XCJtb2RhbF9fdGl0bGVcIj7QntC90LvQsNC50L0g0LfQsNC60LDQtyDRgtC+0YDRgtCwPC9oMj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9faW5mb1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9faW1nLWJsb2NrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHt0YXJnZXQuZGF0YXNldC5pbWd9XCIgYWx0PVwidG9ydFwiIGNsYXNzPVwibW9kYWxfX2ltZ1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbF9fZGVzY3JpcHRpb25cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGg1IGNsYXNzPVwibW9kYWxfX25hbWVcIj4ke3RhcmdldC5kYXRhc2V0Lm5hbWVUb3J0fTwvaDU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwibW9kYWxfX3RleHRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7dGFyZ2V0LmRhdGFzZXQuZGVzY3JpcHRpb259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19ib3R0b21cIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX2xpbmVcIj48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibW9kYWxfX29waXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19ncmFtXCI+JHt0YXJnZXQuZGF0YXNldC5rZ30g0LrQsy48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsX19wcmljZVwiPiR7dGFyZ2V0LmRhdGFzZXQucnVifSDigr08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICBgO1xyXG4gICAgICAgICAgICBibG9jay5hcHBlbmQoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0VG9ydCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgICAgICAgaW5wdXRUb3J0LmNsYXNzTGlzdC5hZGQoXCJpbnB1dF9faGlkZGVuXCIpO1xyXG4gICAgICAgICAgICBpbnB1dFRvcnQudmFsdWUgPSB0YXJnZXQuZGF0YXNldC5uYW1lVG9ydDtcclxuICAgICAgICAgICAgaW5wdXRUb3J0LnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJ0b3J0XCIpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhpZGRlbl9fbGFiZWxcIikuYXBwZW5kKGlucHV0VG9ydCk7XHJcbiAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KVxyXG4gICAgLy8gfSlcclxuXHJcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHwgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfY2xvc2VcIikpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiXCI7XHJcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLnRyYW5zaXRpb24gPSBcIm5vbmVcIjtcclxuICAgICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5mb1RvcnRcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGlkZGVuX19sYWJlbFwiKS5xdWVyeVNlbGVjdG9yKFwiLmlucHV0X19oaWRkZW5cIikucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufSBjYXRjaCB7fSIsInRyeSB7XHJcbiAgICBjb25zdCBjb250cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29udFwiKTtcclxuXHJcbiAgICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFwcGxpY2F0aW9uXCIpLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYXBwbGljYXRpb24taW5wdXRcIik7XHJcblxyXG5cclxuXHJcbiAgICAvLyBjb250cy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgLy8gICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAvLyAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQuY2xvc2VzdChcIi5jb250XCIpO1xyXG4gICAgLy8gICAgIHRhcmdldC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIikuZm9jdXMoKTtcclxuICAgIC8vICAgICB0YXJnZXQucXVlcnlTZWxlY3RvcihcIi5wbGFjZWhvbGRlclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vIH0pXHJcblxyXG4gICAgY29udHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicGxhY2Vob2xkZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIGUudGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBpbnB1dHMuZm9yRWFjaChpdGVtID0+IHtcclxuXHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldC52YWx1ZS50cmltKCkgPT0gJycpXHJcbiAgICAgICAgICAgIGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59IGNhdGNoIHt9XHJcblxyXG4iLCJ0cnkge1xyXG4gICAgY29uc3QgbGFiZWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcHBsaWNhdGlvbl9fbGFiZWxcIik7XHJcblxyXG4gICAgbGFiZWxzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG9sZENoZWNrQm94cyA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuYXBwbGljYXRpb25fX2xhYmVsXCIpLnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94XCIpXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0NoZWNrQm94cyA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIuYXBwbGljYXRpb25fX2xhYmVsXCIpLnF1ZXJ5U2VsZWN0b3IoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrXCIpXHJcblxyXG4gICAgICAgICAgICBpZiAoIW9sZENoZWNrQm94cy5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRydWVcIilcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrXCIpLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYXBwbGljYXRpb25fX2NoZWNrYm94XCIpLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICBuZXdDaGVja0JveHMuY2xhc3NMaXN0LmFkZChcImFwcGxpY2F0aW9uX19jaGVja2JveC1ibG9jay1hY3RpdmVcIilcclxuICAgICAgICAgICAgICAgIG9sZENoZWNrQm94cy5jaGVja2VkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChvbGRDaGVja0JveHMuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAvLyAgICAgb2xkQ2hlY2tCb3hzLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gICAgIG5ld0NoZWNrQm94cy5jbGFzc0xpc3QucmVtb3ZlKFwiYXBwbGljYXRpb25fX2NoZWNrYm94LWJsb2NrLWFjdGl2ZVwiKVxyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgb2xkQ2hlY2tCb3hzLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAvLyAgICAgbmV3Q2hlY2tCb3hzLmNsYXNzTGlzdC5hZGQoXCJhcHBsaWNhdGlvbl9fY2hlY2tib3gtYmxvY2stYWN0aXZlXCIpXHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufSBjYXRjaCB7fSIsImlmICh3aW5kb3cuTm9kZUxpc3QgJiYgIU5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoKSB7XHJcbiAgICBOb2RlTGlzdC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICAgIHRoaXNBcmcgPSB0aGlzQXJnIHx8IHdpbmRvdztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCB0aGlzW2ldLCBpLCB0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbnRyeSB7XHJcbiAgICAvLyBpZiAoIUFycmF5LnByb3RvdHlwZS5mb3JFYWNoKSB7XHJcblxyXG4gICAgLy8gICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrLCB0aGlzQXJnKSB7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgdmFyIFQsIGs7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xyXG4gICAgLy8gICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcgdGhpcyBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gMS4g0J/QvtC70L7QttC40LwgTyDRgNCw0LLQvdGL0Lwg0YDQtdC30YPQu9GM0YLQsNGC0YMg0LLRi9C30L7QstCwIFRvT2JqZWN0IHBhc3NpbmcgdGhlIHx0aGlzfCB2YWx1ZSBhcyB0aGUgYXJndW1lbnQuXHJcbiAgICAvLyAgICAgICB2YXIgTyA9IE9iamVjdCh0aGlzKTtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAvLyAyLiDQn9C+0LvQvtC20LjQvCBsZW5WYWx1ZSDRgNCw0LLQvdGL0Lwg0YDQtdC30YPQu9GM0YLQsNGC0YMg0LLRi9C30L7QstCwINCy0L3Rg9GC0YDQtdC90L3QtdCz0L4g0LzQtdGC0L7QtNCwIEdldCDQvtCx0YrQtdC60YLQsCBPINGBINCw0YDQs9GD0LzQtdC90YLQvtC8IFwibGVuZ3RoXCIuXHJcbiAgICAvLyAgICAgICAvLyAzLiDQn9C+0LvQvtC20LjQvCBsZW4g0YDQsNCy0L3Ri9C8IFRvVWludDMyKGxlblZhbHVlKS5cclxuICAgIC8vICAgICAgIHZhciBsZW4gPSBPLmxlbmd0aCA+Pj4gMDtcclxuICAgICAgXHJcbiAgICAvLyAgICAgICAvLyA0LiDQldGB0LvQuCBJc0NhbGxhYmxlKGNhbGxiYWNrKSDRgNCw0LLQtdC9IGZhbHNlLCDQstGL0LrQuNC90LXQvCDQuNGB0LrQu9GO0YfQtdC90LjQtSBUeXBlRXJyb3IuXHJcbiAgICAvLyAgICAgICAvLyDQodC80L7RgtGA0LjRgtC1OiBodHRwOi8vZXM1LmdpdGh1Yi5jb20vI3g5LjExXHJcbiAgICAvLyAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAvLyAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihjYWxsYmFjayArICcgaXMgbm90IGEgZnVuY3Rpb24nKTtcclxuICAgIC8vICAgICAgIH1cclxuICAgICAgXHJcbiAgICAvLyAgICAgICAvLyA1LiDQldGB0LvQuCB0aGlzQXJnINC/0YDQuNGB0YPRgtGB0YLQstGD0LXRgiwg0L/QvtC70L7QttC40LwgVCDRgNCw0LLQvdGL0LwgdGhpc0FyZzsg0LjQvdCw0YfQtSDQv9C+0LvQvtC20LjQvCBUINGA0LDQstC90YvQvCB1bmRlZmluZWQuXHJcbiAgICAvLyAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcclxuICAgIC8vICAgICAgICAgVCA9IHRoaXNBcmc7XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gNi4g0J/QvtC70L7QttC40LwgayDRgNCw0LLQvdGL0LwgMFxyXG4gICAgLy8gICAgICAgayA9IDA7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgLy8gNy4g0J/QvtC60LAgayA8IGxlbiwg0LHRg9C00LXQvCDQv9C+0LLRgtC+0YDRj9GC0YxcclxuICAgIC8vICAgICAgIHdoaWxlIChrIDwgbGVuKSB7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgICB2YXIga1ZhbHVlO1xyXG4gICAgICBcclxuICAgIC8vICAgICAgICAgLy8gYS4g0J/QvtC70L7QttC40LwgUGsg0YDQsNCy0L3Ri9C8IFRvU3RyaW5nKGspLlxyXG4gICAgLy8gICAgICAgICAvLyAgINCt0YLQviDQvdC10Y/QstC90L7QtSDQv9GA0LXQvtCx0YDQsNC30L7QstCw0L3QuNC1INC00LvRjyDQu9C10LLQvtGB0YLQvtGA0L7QvdC90LXQs9C+INC+0L/QtdGA0LDQvdC00LAg0LIg0L7Qv9C10YDQsNGC0L7RgNC1IGluXHJcbiAgICAvLyAgICAgICAgIC8vIGIuINCf0L7Qu9C+0LbQuNC8IGtQcmVzZW50INGA0LDQstC90YvQvCDRgNC10LfRg9C70YzRgtCw0YLRgyDQstGL0LfQvtCy0LAg0LLQvdGD0YLRgNC10L3QvdC10LPQviDQvNC10YLQvtC00LAgSGFzUHJvcGVydHkg0L7QsdGK0LXQutGC0LAgTyDRgSDQsNGA0LPRg9C80LXQvdGC0L7QvCBQay5cclxuICAgIC8vICAgICAgICAgLy8gICDQrdGC0L7RgiDRiNCw0LMg0LzQvtC20LXRgiDQsdGL0YLRjCDQvtCx0YrQtdC00LjQvdGR0L0g0YEg0YjQsNCz0L7QvCBjXHJcbiAgICAvLyAgICAgICAgIC8vIGMuINCV0YHQu9C4IGtQcmVzZW50INGA0LDQstC10L0gdHJ1ZSwg0YLQvlxyXG4gICAgLy8gICAgICAgICBpZiAoayBpbiBPKSB7XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgICAgIC8vIGkuINCf0L7Qu9C+0LbQuNC8IGtWYWx1ZSDRgNCw0LLQvdGL0Lwg0YDQtdC30YPQu9GM0YLQsNGC0YMg0LLRi9C30L7QstCwINCy0L3Rg9GC0YDQtdC90L3QtdCz0L4g0LzQtdGC0L7QtNCwIEdldCDQvtCx0YrQtdC60YLQsCBPINGBINCw0YDQs9GD0LzQtdC90YLQvtC8IFBrLlxyXG4gICAgLy8gICAgICAgICAgIGtWYWx1ZSA9IE9ba107XHJcbiAgICAgIFxyXG4gICAgLy8gICAgICAgICAgIC8vIGlpLiDQktGL0LfQvtCy0LXQvCDQstC90YPRgtGA0LXQvdC90LjQuSDQvNC10YLQvtC0IENhbGwg0YTRg9C90LrRhtC40LggY2FsbGJhY2sg0YEg0L7QsdGK0LXQutGC0L7QvCBUINCyINC60LDRh9C10YHRgtCy0LUg0LfQvdCw0YfQtdC90LjRjyB0aGlzINC4XHJcbiAgICAvLyAgICAgICAgICAgLy8g0YHQv9C40YHQutC+0Lwg0LDRgNCz0YPQvNC10L3RgtC+0LIsINGB0L7QtNC10YDQttCw0YnQuNC8IGtWYWx1ZSwgayDQuCBPLlxyXG4gICAgLy8gICAgICAgICAgIGNhbGxiYWNrLmNhbGwoVCwga1ZhbHVlLCBrLCBPKTtcclxuICAgIC8vICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICAvLyBkLiDQo9Cy0LXQu9C40YfQuNC8IGsg0L3QsCAxLlxyXG4gICAgLy8gICAgICAgICBrKys7XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAvLyAgICAgICAvLyA4LiDQktC10YDQvdGR0LwgdW5kZWZpbmVkLlxyXG4gICAgLy8gICAgIH07XHJcbiAgICAvLyAgIH1cclxuICAgICAgKGZ1bmN0aW9uKEVMRU1FTlQpIHtcclxuICAgICAgICBFTEVNRU5ULm1hdGNoZXMgPSBFTEVNRU5ULm1hdGNoZXMgfHwgRUxFTUVOVC5tb3pNYXRjaGVzU2VsZWN0b3IgfHwgRUxFTUVOVC5tc01hdGNoZXNTZWxlY3RvciB8fCBFTEVNRU5ULm9NYXRjaGVzU2VsZWN0b3IgfHwgRUxFTUVOVC53ZWJraXRNYXRjaGVzU2VsZWN0b3I7XHJcbiAgICAgICAgRUxFTUVOVC5jbG9zZXN0ID0gRUxFTUVOVC5jbG9zZXN0IHx8IGZ1bmN0aW9uIGNsb3Nlc3Qoc2VsZWN0b3IpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzKSByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgaWYgKHRoaXMubWF0Y2hlcyhzZWxlY3RvcikpIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50RWxlbWVudCkge3JldHVybiBudWxsfVxyXG4gICAgICAgICAgICBlbHNlIHJldHVybiB0aGlzLnBhcmVudEVsZW1lbnQuY2xvc2VzdChzZWxlY3RvcilcclxuICAgICAgICAgIH07XHJcbiAgICB9KEVsZW1lbnQucHJvdG90eXBlKSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgXHJcbi8vICAgdmFyIG15U3dpcGVyID0gbmV3IFN3aXBlciAoJy5zd2lwZXItY29udGFpbmVyJywge1xyXG4vLyAgICAgLy8g0L3QsNC/0YDQsNCy0LvQtdC90LjQtTogwqvQstC10YDRgtC40LrQsNC70YzQvdC+0LXCuywgLy8g0L7Qv9GG0LjRjyDQstC10YDRgtC40LrQsNC70YzQvdC+0LPQviDQv9C10YDQtdC60LvRjtGH0LXQvdC40Y8gKNC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOINC/0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQv9C+INCz0L7RgNC40LfQvtC90YLQsNC70LgsINC10YHQu9C4INC90LUg0YPRgdGC0LDQvdC+0LLQu9C10L3QvilcclxuLy8gICAgIGxvb3A6IHRydWUsIC8vINC+0L/RhtC40Y8g0YDQtdC20LjQvNCwINC/0LXRgtC70LhcclxuXHJcbi8vICAgICAvLyDQldGB0LvQuCDQvdGD0LbQtdC9INC/0LXQudC00LbQtdGAXHJcbi8vIHBhZ2luYXRpb246IHtcclxuLy8gIGVsOiAnLnN3aXBlci1wYWdpbmF0aW9uJyxcclxuLy8gfSxcclxuXHJcbi8vICAgICAvLyDQldGB0LvQuCDQstCw0Lwg0L3Rg9C20L3QviDQtNCy0LjQs9Cw0YLRjNGB0Y8g0LLQv9C10YDQtdC0INC4INC90LDQt9Cw0LRcclxuLy8gbmF2aWdhdGlvbjoge1xyXG4vLyAgbmV4dEVsOiAnLnN3aXBlci1idXR0b24tbmV4dCcsXHJcbi8vICBwcmV2RWw6ICcuc3dpcGVyLWJ1dHRvbi1wcmV2JyxcclxuLy8gfSxcclxuXHJcbi8vICAgICAvLyDQldGB0LvQuCDQstCw0Lwg0L3Rg9C20L3QsCDQv9C+0LvQvtGB0LAg0L/RgNC+0LrRgNGD0YLQutC4XHJcbi8vIHNjcm9sbGJhcjoge1xyXG4vLyAgZWw6ICcuc3dpcGVyLXNjcm9sbGJhcicsXHJcbi8vIH0sXHJcbi8vIH0pXHJcblxyXG4vLyBjb25zdCBzd2lwZXIgPSBuZXcgU3dpcGVyKCcuc3dpcGVyLWNvbnRhaW5lcicsIHtcclxuLy8gICAgIG5hdmlnYXRpb246IHtcclxuLy8gICAgICAgICBuZXh0RWw6ICcuc3dpcGVyLWJ1dHRvbi1uZXh0JyxcclxuLy8gICAgICAgICBwcmV2RWw6ICcuc3dpcGVyLWJ1dHRvbi1wcmV2JyxcclxuLy8gICAgICAgfSxcclxuLy8gICB9KTtcclxudmFyIHN3aXBlciA9IG5ldyBTd2lwZXIoJy5zd2lwZXItY29udGFpbmVyJywge1xyXG4gICAgc2xpZGVzUGVyVmlldzogMSxcclxuICAgIHNwYWNlQmV0d2VlbjogMzAsXHJcbiAgICBsb29wOiB0cnVlLFxyXG4gICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICBlbDogJy5zd2lwZXItcGFnaW5hdGlvbicsXHJcbiAgICAgIGNsaWNrYWJsZTogdHJ1ZSxcclxuICAgIH0sXHJcbiAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgIG5leHRFbDogJy5zd2lwZXItYnV0dG9uLW5leHQnLFxyXG4gICAgICBwcmV2RWw6ICcuc3dpcGVyLWJ1dHRvbi1wcmV2JyxcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG5cclxuLy8gICBzd2lwZXIuc2xpZGVOZXh0KCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgLy8gY29uc3Qgd2lkdGggPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fd3JhcHBlclwiKSkud2lkdGg7XHJcbiAgICAvLyBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX3dyYXBwZXJcIik7XHJcbiAgICAvLyBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyX19pdGVtXCIpO1xyXG4gICAgLy8gY29uc3QgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19jb250ZW50XCIpO1xyXG4gICAgLy8gY29uc3QgcHJldiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19sZWZ0XCIpO1xyXG4gICAgLy8gY29uc3QgbmV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19yaWdodFwiKTtcclxuICAgIC8vIGNvbnN0IHNsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyXCIpO1xyXG5cclxuLy8gbGV0IGNvdW50ID0gMTtcclxuXHJcblxyXG4vLyBmdW5jdGlvbiBhZGREb3RzKCkge1xyXG4vLyAgICAgY29uc3QgZG90cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbi8vICAgICBkb3RzLmNsYXNzTGlzdC5hZGQoXCJzbGlkZXJfX2RvdHNcIik7XHJcblxyXG5cclxuLy8gICAgIGVsZW1lbnRzLmZvckVhY2goKGVsLCBpbmRleCkgPT4ge1xyXG4vLyAgICAgICAgIGNvbnN0IGRvdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcclxuLy8gICAgICAgICBkb3QuY2xhc3NMaXN0LmFkZChcInNsaWRlcl9fZG90XCIpO1xyXG4vLyAgICAgICAgIGRvdC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWNvdW50XCIsIGluZGV4ICsgMSlcclxuLy8gICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcclxuLy8gICAgICAgICAgICAgZG90LmNsYXNzTGlzdC5hZGQoXCJzbGlkZXJfX2RvdC1hY3RpdmVcIik7ICBcclxuLy8gICAgICAgICB9XHJcbi8vICAgICAgICAgZG90cy5hcHBlbmRDaGlsZChkb3QpO1xyXG4vLyAgICAgfSlcclxuXHJcbi8vICAgICAvLyBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBcclxuLy8gICAgIC8vIH1cclxuXHJcblxyXG4vLyAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJcIikuYXBwZW5kQ2hpbGQoZG90cyk7XHJcbi8vIH1cclxuLy8gYWRkRG90cygpO1xyXG5cclxuXHJcbi8vIGNvbnRlbnQuc3R5bGUud2lkdGggPSBlbGVtZW50cy5sZW5ndGggKiBwYXJzZUludCh3aWR0aCkgKyBcInB4XCI7XHJcblxyXG4vLyBuZXh0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBnb05leHQpO1xyXG4vLyBwcmV2LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBnb1ByZXYpO1xyXG5cclxuLy8gbGV0IGludGVydmFsO1xyXG5cclxuLy8gZnVuY3Rpb24gc3RhcnRJbnRlcnZhbCgpIHtcclxuLy8gICAgIGludGVydmFsID0gc2V0SW50ZXJ2YWwoZ29OZXh0LCA2MDAwKTtcclxuLy8gfVxyXG4vLyBzdGFydEludGVydmFsKCk7XHJcblxyXG4vLyB3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsICgpID0+IHtcclxuLy8gICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xyXG4vLyB9KVxyXG5cclxuLy8gd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCAoKSA9PiB7XHJcbi8vICAgICBzdGFydEludGVydmFsKCk7XHJcbi8vIH0pXHJcblxyXG4vLyBzbGlkZXIucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXJfX2RvdFwiKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4vLyAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IGNoYW5nZURvdHMoZSwgbnVsbCkpXHJcbi8vIH0pXHJcblxyXG4vLyBmdW5jdGlvbiBjaGFuZ2VEb3RzKGUsIGNvbG9yKSB7XHJcbi8vICAgICBpZiAoZSkge1xyXG4vLyAgICAgICAgIHNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKFwiLnNsaWRlcl9fZG90XCIpLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbi8vICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInNsaWRlcl9fZG90LWFjdGl2ZVwiKTtcclxuLy8gICAgICAgICB9KVxyXG4vLyAgICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoXCJzbGlkZXJfX2RvdC1hY3RpdmVcIik7XHJcbi8vICAgICAgICAgY29uc3QgaW5kZXggPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWNvdW50XCIpO1xyXG5cclxuLy8gICAgICAgICBjb3VudCA9IGluZGV4O1xyXG4vLyAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChjb3VudCAqIHBhcnNlSW50KHdpZHRoKSkgLSBwYXJzZUludCh3aWR0aCk7XHJcbi8vICAgICAgICAgY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtyZXN1bHR9cHgpYDtcclxuLy8gICAgIH1cclxuXHJcbi8vICAgICBpZiAoY29sb3IpIHtcclxuLy8gICAgICAgICBzbGlkZXIucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXJfX2RvdFwiKS5mb3JFYWNoKChpdGVtLCBpbmRleCk9PiB7XHJcbi8vICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShcInNsaWRlcl9fZG90LWFjdGl2ZVwiKTtcclxuLy8gICAgICAgICAgICAgaWYgKGluZGV4KzEgPT09IGNvdW50KSB7XHJcbi8vICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJzbGlkZXJfX2RvdC1hY3RpdmVcIik7XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICB9KTtcclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuLy8gZnVuY3Rpb24gZ29OZXh0KCkge1xyXG4vLyAgICAgaWYgKGNvdW50ID09PSBlbGVtZW50cy5sZW5ndGgpIHtcclxuLy8gICAgICAgICBjb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKDApYDtcclxuLy8gICAgICAgICBjb3VudCA9IDE7XHJcbi8vICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgIGNvdW50Kys7XHJcbi8vICAgICAgICAgY29uc3QgcmVzdWx0ID0gKGNvdW50IC0gMSkgKiBwYXJzZUludCh3aWR0aCk7XHJcbi8vICAgICAgICAgY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtyZXN1bHR9cHgpYDtcclxuLy8gICAgIH1cclxuLy8gICAgIGNoYW5nZURvdHMobnVsbCwgXCJjaGFuZ2VDb2xvclwiKVxyXG4vLyB9XHJcblxyXG4vLyBmdW5jdGlvbiBnb1ByZXYoKSB7XHJcbi8vICAgICBpZiAoY291bnQgPT09IDEpIHtcclxuLy8gICAgICAgICBjb25zdCByZXN1bHQgPSggKGVsZW1lbnRzLmxlbmd0aCAtIDEpICogcGFyc2VJbnQod2lkdGgpKSArIFwicHhcIjtcclxuLy8gICAgICAgICBjb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3Jlc3VsdH0pYDtcclxuLy8gICAgICAgICBjb3VudCA9IGVsZW1lbnRzLmxlbmd0aDtcclxuLy8gICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgY291bnQtLTtcclxuLy8gICAgICAgICBjb25zdCByZXN1bHQgPSAoY291bnQgKiBwYXJzZUludCh3aWR0aCkpIC0gcGFyc2VJbnQod2lkdGgpO1xyXG4vLyAgICAgICAgIGNvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7cmVzdWx0fXB4KWA7XHJcbi8vICAgICB9XHJcbi8vICAgICBjaGFuZ2VEb3RzKG51bGwsIFwiY2hhbmdlQ29sb3JcIilcclxuLy8gfVxyXG5cclxuLy8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX2J1dHRvbnNcIikuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIGUgPT4ge1xyXG4vLyAgICAgY29uc3QgZWwgPSBlLnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX2NvbnRlbnRcIik7XHJcbi8vICAgICAvLyBlbC5wb2ludGVybW92ZSgoKSA9PiB7XHJcbi8vICAgICAvLyAgICAgY29uc29sZS5sb2coXCJmZmZcIilcclxuLy8gICAgIC8vIH0pXHJcbi8vICAgICBjb25zb2xlLmxvZyhlKTtcclxuLy8gICAgIGNvbnNvbGUubG9nKGVsKTtcclxuLy8gICAgIC8vIGRvY3VtZW50Lm9ucG9pbnRlcm1vdmUgPSAoKSA9PiB7XHJcbi8vICAgICAvLyAgICAgY29uc29sZS5sb2coXCJbZltmW2ZcIilcclxuLy8gICAgIC8vIH07XHJcbi8vICAgICBkb2N1bWVudC5vbnBvaW50ZXJ1cCA9ICgpID0+IHtcclxuLy8gICAgICAgICBjb25zb2xlLmxvZyhcImZmZlwiKTtcclxuLy8gICAgIH1cclxuLy8gfSk7XHJcblxyXG59XHJcblxyXG5jYXRjaCB7fSJdfQ==
})